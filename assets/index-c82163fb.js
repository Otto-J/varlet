import{F as ke,u as Fe}from"./provide-d4683ddf.js";import{d as O,k as $e,a as $,e as Ne,c as Ce}from"./components-105afbd7.js";import{H as Te,u as te}from"./index-6c867e4a.js";import{v as He}from"./index-614c1e59.js";import{m as ze,l as Pe}from"./elements-daad42ba.js";import{w as ne}from"./logger-525ef361.js";import{d as we,a as B,r as De,b as p,w as re,Z as o,ay as f,ap as E,X as W,n as Me,_ as Oe,p as ae,ag as Le,f as A,h as I,M as b,N as d,R as N,F as Ue,ai as Be,ah as le,O as Ee,D as We,q as oe,Q as Ae}from"./vue-router-3467edf1.js";function Ie(e){return["always","normal","never"].includes(e)}var l=(e=>(e.First="1",e.Second="2",e))(l||{});const Xe={modelValue:{type:[Number,Array],default:0},step:{type:[Number,String],default:1},range:{type:Boolean,default:!1},labelVisible:{type:String,default:"normal",validator:Ie},activeColor:{type:String},trackColor:{type:String},thumbColor:{type:String},labelColor:{type:String},labelTextColor:{type:String},trackHeight:{type:[String,Number]},max:{type:[String,Number],default:100},min:{type:[String,Number],default:0},thumbSize:{type:[String,Number]},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},direction:{type:String,default:"horizontal"},rules:{type:Array},onChange:O(),onStart:O(),onEnd:O(),"onUpdate:modelValue":O()},{n:ie,classes:Re}=Ce("slider"),Ye=we({name:"VarSlider",components:{VarFormDetails:ke,VarHoverOverlay:Te},directives:{Hover:He},props:Xe,setup(e){const{bindForm:T,form:V}=Fe(),{errorMessage:R,validateWithTrigger:Y,validate:q,resetValidation:H}=$e(),{hovering:z,handleHovering:P}=te(),{hovering:i,handleHovering:v}=te(),se=()=>q(e.rules,e.modelValue),Q=()=>({startPosition:0,currentOffset:0,active:!1,percentValue:0}),ue=()=>Me(()=>Y(["onChange"],"onChange",e.rules,e.modelValue)),L=B(null),h=B(0),w=B(!1),a=De({[l.First]:Q(),[l.Second]:Q()}),U=p(()=>o(e.max)-o(e.min)),S=p(()=>h.value/U.value*o(e.step)),ce=p(()=>{const{modelValue:t,range:n}=e;let r=[];return n&&f(t)?r=[{value:k(t[0]),enumValue:l.First,text:C(t[0]),hovering:E(z),handleHovering:P},{value:k(t[1]),enumValue:l.Second,text:C(t[1]),hovering:E(i),handleHovering:v}]:W(t)&&(r=[{value:k(t),enumValue:l.First,text:C(t),hovering:E(z),handleHovering:P}]),r}),de=p(()=>{const{activeColor:t,range:n,modelValue:r}=e,s=n&&f(r)?k(Math.min(r[0],r[1])):0,u=n&&f(r)?k(Math.max(r[0],r[1]))-s:k(r);return y.value?{left:"0px",height:`${u}%`,bottom:`${s}%`,background:t}:{top:"0px",width:`${u}%`,left:`${s}%`,background:t}}),g=p(()=>e.disabled||(V==null?void 0:V.disabled.value)),D=p(()=>e.readonly||(V==null?void 0:V.readonly.value)),y=p(()=>e.direction==="vertical"),ve=t=>{const n=t.currentTarget;return n?y.value?h.value-(t.clientY-n.getBoundingClientRect().top):t.clientX-Pe(n):0},me=t=>({[y.value?"bottom":"left"]:`${t.value}%`,zIndex:a[t.enumValue].active?1:void 0}),fe=t=>e.labelVisible==="always"?!0:e.labelVisible==="never"?!1:a[t].active,k=t=>{const{min:n,max:r}=e;return t<o(n)?0:t>o(r)?100:(t-o(n))/U.value*100},C=t=>{if(!W(t))return 0;let n=t;return n<Number(e.min)&&(n=Number(e.min)),n>Number(e.max)&&(n=Number(e.max)),parseInt(`${n}`,10)===n?n:o(n.toPrecision(5))},he=(t,n)=>{g.value||n.handleHovering(t)},Z=(t,n)=>{let r=[];const{step:s,range:u,modelValue:m,onChange:c,min:F}=e,_=o(s),x=Math.round(t/S.value),M=x*_+o(F),ye=a[n].percentValue*_+o(F);if(a[n].percentValue=x,u&&f(m)&&(r=n===l.First?[M,m[1]]:[m[0],M]),ye!==M){const ee=u?r.map(pe=>C(pe)):C(M);$(c,ee),$(e["onUpdate:modelValue"],ee),ue()}},ge=t=>{if(!e.range)return l.First;const n=a[l.First].percentValue*S.value,r=a[l.Second].percentValue*S.value,s=Math.abs(t-n),u=Math.abs(t-r);return s<=u?l.First:l.Second},be=(t,n)=>{h.value||(h.value=L.value.offsetWidth),g.value||(a[n].active=!0),!(g.value||D.value)&&($(e.onStart),w.value=!0,a[n].startPosition=t.touches[0][y.value?"clientY":"clientX"])},Ve=(t,n)=>{if(g.value||D.value||!w.value)return;const{startPosition:r,currentOffset:s}=a[n],{clientX:u,clientY:m}=t.touches[0];let c=(y.value?r-m:u-r)+s;c<=0?c=0:c>=h.value&&(c=h.value),Z(c,n)},j=t=>{const{range:n,modelValue:r,onEnd:s,step:u,min:m}=e;if(g.value||(a[t].active=!1),g.value||D.value)return;let c=[];a[t].currentOffset=a[t].percentValue*S.value;const F=a[t].percentValue*o(u)+o(m);n&&f(r)&&(c=t===l.First?[F,r[1]]:[r[0],F]),$(s,n?c:F),w.value=!1},Se=t=>{if(g.value||D.value||t.target.closest(`.${ie("thumb")}`))return;const n=ve(t),r=ge(n);Z(n,r),j(r)},G=()=>{const t=o(e.step);return isNaN(t)?(ne("Slider",'type of prop "step" should be Number'),!1):t<0?(ne("Slider",'"step" should be > 0'),!1):!0},J=()=>{const{range:t,modelValue:n}=e;return t&&!f(n)?(console.error('[Varlet] Slider: "modelValue" should be an Array'),!1):!t&&f(n)?(console.error('[Varlet] Slider: "modelValue" should be a Number'),!1):t&&f(n)&&n.length<2?(console.error('[Varlet] Slider: "modelValue" should have two value'),!1):!0},K=(t=e.modelValue,n=o(e.step))=>{const r=s=>{const{min:u,max:m}=e;return s<o(u)?0:s>o(m)?U.value/n:(s-o(u))/n};e.range&&f(t)?(a[l.First].percentValue=r(t[0]),a[l.First].currentOffset=a[l.First].percentValue*S.value,a[l.Second].percentValue=r(t[1]),a[l.Second].currentOffset=a[l.Second].percentValue*S.value):W(t)&&(a[l.First].currentOffset=r(t)*S.value)};return $(T,{reset:()=>{const t=e.range?[0,0]:0;$(e["onUpdate:modelValue"],t),H()},validate:se,resetValidation:H}),re([()=>e.modelValue,()=>e.step],([t,n])=>{!G()||!J()||w.value||K(t,o(n))}),re(h,()=>K()),Ne(()=>{!G()||!J()||(h.value=L.value[y.value?"offsetHeight":"offsetWidth"])}),{n:ie,classes:Re,Thumbs:l,sliderEl:L,getFillStyle:de,isDisabled:g,isVertical:y,thumbStyle:me,errorMessage:R,thumbsProps:a,thumbList:ce,hover:he,multiplySizeUnit:ze,toNumber:o,showLabel:fe,start:be,move:Ve,end:j,click:Se}}});const qe=["onTouchstart","onTouchmove","onTouchend","onTouchcancel"];function Qe(e,T,V,R,Y,q){const H=ae("var-hover-overlay"),z=ae("var-form-details"),P=Le("hover");return A(),I("div",{class:d(e.n(e.direction))},[b("div",{class:d(e.classes(e.n(`${e.direction}__block`),[e.isDisabled,e.n("--disabled")],[e.errorMessage,e.n("--error")])),ref:"sliderEl",onClick:T[0]||(T[0]=(...i)=>e.click&&e.click(...i))},[b("div",{class:d(e.n(`${e.direction}__track`))},[b("div",{class:d(e.n(`${e.direction}__track-background`)),style:N({background:e.trackColor,height:e.isVertical?"100%":e.multiplySizeUnit(e.trackHeight),width:e.isVertical?e.multiplySizeUnit(e.trackHeight):"100%"})},null,6),b("div",{class:d(e.n(`${e.direction}__track-fill`)),style:N(e.getFillStyle)},null,6)],2),(A(!0),I(Ue,null,Be(e.thumbList,i=>(A(),I("div",{class:d(e.n(`${e.direction}__thumb`)),key:i.enumValue,style:N(e.thumbStyle(i)),onTouchstart:le(v=>e.start(v,i.enumValue),["stop"]),onTouchmove:le(v=>e.move(v,i.enumValue),["stop"]),onTouchend:v=>e.end(i.enumValue),onTouchcancel:v=>e.end(i.enumValue)},[Ee(e.$slots,"button",{currentValue:i.text},()=>[We(b("div",{class:d(e.n(`${e.direction}__thumb-block`)),style:N({background:e.thumbColor})},null,6),[[P,v=>e.hover(v,i),"desktop"]]),b("div",{class:d(e.classes(e.n(`${e.direction}__thumb-ripple`),[e.thumbsProps[i.enumValue].active,e.n(`${e.direction}__thumb-ripple--active`)])),style:N({background:e.thumbsProps[i.enumValue].active?e.thumbColor:void 0})},[oe(H,{hovering:i.hovering},null,8,["hovering"])],6),b("div",{class:d(e.classes(e.n(`${e.direction}__thumb-label`),[e.showLabel(i.enumValue),e.n(`${e.direction}__thumb-label--active`)])),style:N({background:e.labelColor,color:e.labelTextColor,height:e.thumbSize===void 0?e.thumbSize:e.multiplySizeUnit(e.thumbSize,2),width:e.thumbSize===void 0?e.thumbSize:e.multiplySizeUnit(e.thumbSize,2)})},[b("span",null,Ae(i.text),1)],6)])],46,qe))),128))],2),oe(z,{"error-message":e.errorMessage,class:d(e.n("form")),"var-slider-cover":""},null,8,["error-message","class"])],2)}const X=Oe(Ye,[["render",Qe]]);X.install=function(e){e.component(X.name,X)};export{X as S};
