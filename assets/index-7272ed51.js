import{F as pe,u as $e}from"./provide-d4683ddf.js";import{d as O,k as Fe,a as $,e as Te,c as Ne}from"./components-105afbd7.js";import{H as Ce,u as te}from"./index-6c867e4a.js";import{v as ze}from"./index-614c1e59.js";import{m as He,l as Pe,o as we}from"./elements-d7e8d9e4.js";import{w as ne}from"./logger-525ef361.js";import{d as De,a as B,r as Me,b as S,w as re,Z as o,ay as v,ap as E,X as I,n as Oe,_ as Le,p as ae,ag as Ue,f as W,h as A,M as h,N as c,R as F,F as Be,ai as Ee,ah as le,O as Ie,D as We,q as oe,Q as Ae}from"./vue-router-3467edf1.js";function Xe(e){return["always","normal","never"].includes(e)}var l=(e=>(e.First="1",e.Second="2",e))(l||{});const Ye={modelValue:{type:[Number,Array],default:0},step:{type:[Number,String],default:1},range:{type:Boolean,default:!1},labelVisible:{type:String,default:"normal",validator:Xe},activeColor:{type:String},trackColor:{type:String},thumbColor:{type:String},labelColor:{type:String},labelTextColor:{type:String},trackHeight:{type:[String,Number]},max:{type:[String,Number],default:100},min:{type:[String,Number],default:0},thumbSize:{type:[String,Number]},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},direction:{type:String,default:"horizontal"},rules:{type:Array},onChange:O(),onStart:O(),onEnd:O(),"onUpdate:modelValue":O()},{n:ie,classes:Re}=Ne("slider"),qe=De({name:"VarSlider",components:{VarFormDetails:pe,VarHoverOverlay:Ce},directives:{Hover:ze},props:Ye,setup(e){const{bindForm:N,form:g}=$e(),{errorMessage:Y,validateWithTrigger:R,validate:q,resetValidation:C}=Fe(),{hovering:z,handleHovering:H}=te(),{hovering:i,handleHovering:d}=te(),se=()=>q(e.rules,e.modelValue),Q=()=>({startPosition:0,currentOffset:0,active:!1,percentValue:0}),ue=()=>Oe(()=>R(["onChange"],"onChange",e.rules,e.modelValue)),L=B(null),m=B(0),P=B(!1),a=Me({[l.First]:Q(),[l.Second]:Q()}),U=S(()=>o(e.max)-o(e.min)),b=S(()=>m.value/U.value*o(e.step)),ce=S(()=>{const{modelValue:t,range:n}=e;let r=[];return n&&v(t)?r=[{value:k(t[0]),enumValue:l.First,text:T(t[0]),hovering:E(z),handleHovering:H},{value:k(t[1]),enumValue:l.Second,text:T(t[1]),hovering:E(i),handleHovering:d}]:I(t)&&(r=[{value:k(t),enumValue:l.First,text:T(t),hovering:E(z),handleHovering:H}]),r}),de=S(()=>{const{activeColor:t,range:n,modelValue:r}=e,s=n&&v(r)?k(Math.min(r[0],r[1])):0,u=n&&v(r)?k(Math.max(r[0],r[1]))-s:k(r);return y.value?{left:"0px",height:`${u}%`,bottom:`${s}%`,background:t}:{top:"0px",width:`${u}%`,left:`${s}%`,background:t}}),f=S(()=>e.disabled||(g==null?void 0:g.disabled.value)),w=S(()=>e.readonly||(g==null?void 0:g.readonly.value)),y=S(()=>e.direction==="vertical"),ve=t=>{const{direction:n}=e,r=t.currentTarget;return r?n==="horizontal"?t.clientX-Pe(r):m.value-(t.clientY-we(r)):0},me=t=>y.value?{bottom:`${t.value}%`,zIndex:a[t.enumValue].active?1:void 0}:{left:`${t.value}%`,zIndex:a[t.enumValue].active?1:void 0},fe=t=>e.labelVisible==="always"?!0:e.labelVisible==="never"?!1:a[t].active,k=t=>{const{min:n,max:r}=e;return t<o(n)?0:t>o(r)?100:(t-o(n))/U.value*100},T=t=>{if(!I(t))return 0;let n=t;return n<Number(e.min)&&(n=Number(e.min)),n>Number(e.max)&&(n=Number(e.max)),parseInt(`${n}`,10)===n?n:o(n.toPrecision(5))},he=(t,n)=>{f.value||n.handleHovering(t)},Z=(t,n)=>{let r=[];const{step:s,range:u,modelValue:V,onChange:D,min:p}=e,_=o(s),x=Math.round(t/b.value),M=x*_+o(p),ye=a[n].percentValue*_+o(p);if(a[n].percentValue=x,u&&v(V)&&(r=n===l.First?[M,V[1]]:[V[0],M]),ye!==M){const ee=u?r.map(ke=>T(ke)):T(M);$(D,ee),$(e["onUpdate:modelValue"],ee),ue()}},ge=t=>{if(!e.range)return l.First;const n=a[l.First].percentValue*b.value,r=a[l.Second].percentValue*b.value,s=Math.abs(t-n),u=Math.abs(t-r);return s<=u?l.First:l.Second},be=(t,n)=>{m.value||(m.value=L.value.offsetWidth),f.value||(a[n].active=!0),!(f.value||w.value)&&($(e.onStart),P.value=!0,a[n].startPosition=t.touches[0][y.value?"clientY":"clientX"])},Ve=(t,n)=>{if(f.value||w.value||!P.value)return;let r=(y.value?a[n].startPosition-t.touches[0].clientY:t.touches[0].clientX-a[n].startPosition)+a[n].currentOffset;r<=0?r=0:r>=m.value&&(r=m.value),Z(r,n)},j=t=>{const{range:n,modelValue:r,onEnd:s,step:u,min:V}=e;if(f.value||(a[t].active=!1),f.value||w.value)return;let D=[];a[t].currentOffset=a[t].percentValue*b.value;const p=a[t].percentValue*o(u)+o(V);n&&v(r)&&(D=t===l.First?[p,r[1]]:[r[0],p]),$(s,n?D:p),P.value=!1},Se=t=>{if(f.value||w.value||t.target.closest(`.${ie("thumb")}`))return;const n=ve(t),r=ge(n);Z(n,r),j(r)},G=()=>{const t=o(e.step);return isNaN(t)?(ne("Slider",'type of prop "step" should be Number'),!1):t<0?(ne("Slider",'"step" should be > 0'),!1):!0},J=()=>{const{range:t,modelValue:n}=e;return t&&!v(n)?(console.error('[Varlet] Slider: "modelValue" should be an Array'),!1):!t&&v(n)?(console.error('[Varlet] Slider: "modelValue" should be a Number'),!1):t&&v(n)&&n.length<2?(console.error('[Varlet] Slider: "modelValue" should have two value'),!1):!0},K=(t=e.modelValue,n=o(e.step))=>{const r=s=>{const{min:u,max:V}=e;return s<o(u)?0:s>o(V)?U.value/n:(s-o(u))/n};e.range&&v(t)?(a[l.First].percentValue=r(t[0]),a[l.First].currentOffset=a[l.First].percentValue*b.value,a[l.Second].percentValue=r(t[1]),a[l.Second].currentOffset=a[l.Second].percentValue*b.value):I(t)&&(a[l.First].currentOffset=r(t)*b.value)};return $(N,{reset:()=>{const t=e.range?[0,0]:0;$(e["onUpdate:modelValue"],t),C()},validate:se,resetValidation:C}),re([()=>e.modelValue,()=>e.step],([t,n])=>{!G()||!J()||P.value||K(t,o(n))}),re(m,()=>K()),Te(()=>{!G()||!J()||(m.value=L.value[y.value?"offsetHeight":"offsetWidth"])}),{n:ie,classes:Re,Thumbs:l,sliderEl:L,getFillStyle:de,isDisabled:f,vertical:y,syncThumbStyle:me,errorMessage:Y,thumbsProps:a,thumbList:ce,hover:he,multiplySizeUnit:He,toNumber:o,showLabel:fe,start:be,move:Ve,end:j,click:Se}}});const Qe=["onTouchstart","onTouchmove","onTouchend","onTouchcancel"];function Ze(e,N,g,Y,R,q){const C=ae("var-hover-overlay"),z=ae("var-form-details"),H=Ue("hover");return W(),A("div",{class:c(e.n(e.direction))},[h("div",{class:c(e.classes(e.n(`${e.direction}__block`),[e.isDisabled,e.n("--disabled")],[e.errorMessage,e.n("--error")])),ref:"sliderEl",onClick:N[0]||(N[0]=(...i)=>e.click&&e.click(...i))},[h("div",{class:c(e.n(`${e.direction}__track`))},[h("div",{class:c(e.n(`${e.direction}__track-background`)),style:F({background:e.trackColor,height:e.vertical?"100%":e.multiplySizeUnit(e.trackHeight),width:e.vertical?e.multiplySizeUnit(e.trackHeight):"100%"})},null,6),h("div",{class:c(e.n(`${e.direction}__track-fill`)),style:F(e.getFillStyle)},null,6)],2),(W(!0),A(Be,null,Ee(e.thumbList,i=>(W(),A("div",{class:c(e.n(`${e.direction}__thumb`)),key:i.enumValue,style:F(e.syncThumbStyle(i)),onTouchstart:le(d=>e.start(d,i.enumValue),["stop"]),onTouchmove:le(d=>e.move(d,i.enumValue),["stop"]),onTouchend:d=>e.end(i.enumValue),onTouchcancel:d=>e.end(i.enumValue)},[Ie(e.$slots,"button",{currentValue:i.text},()=>[We(h("div",{class:c(e.n(`${e.direction}__thumb-block`)),style:F({background:e.thumbColor})},null,6),[[H,d=>e.hover(d,i),"desktop"]]),h("div",{class:c(e.classes(e.n(`${e.direction}__thumb-ripple`),[e.thumbsProps[i.enumValue].active,e.n(`${e.direction}__thumb-ripple--active`)])),style:F({background:e.thumbsProps[i.enumValue].active?e.thumbColor:void 0})},[oe(C,{hovering:i.hovering},null,8,["hovering"])],6),h("div",{class:c(e.classes(e.n(`${e.direction}__thumb-label`),[e.showLabel(i.enumValue),e.n(`${e.direction}__thumb-label--active`)])),style:F({background:e.labelColor,color:e.labelTextColor,height:e.thumbSize===void 0?e.thumbSize:e.multiplySizeUnit(e.thumbSize,2),width:e.thumbSize===void 0?e.thumbSize:e.multiplySizeUnit(e.thumbSize,2)})},[h("span",null,Ae(i.text),1)],6)])],46,Qe))),128))],2),oe(z,{"error-message":e.errorMessage,class:c(e.n("form")),"var-slider-cover":""},null,8,["error-message","class"])],2)}const X=Le(qe,[["render",Ze]]);X.install=function(e){e.component(X.name,X)};export{X as S};
