import{I as ve}from"./index-257e1948.js";import{M as pe}from"./index-d879acfa.js";import{C as be}from"./index-7227ef66.js";import{p as Ce,V as he}from"./FieldDecorator-ee587350.js";import{F as ye,u as Ve}from"./provide-75771484.js";import{d as ge,r as p,B as c,aK as $,F as A,a2 as ke,n as Me,_ as we,b as V,e as u,l as f,p as S,w as b,m as O,t,s as g,aM as Fe,aN as Be,aL as $e,v as H,M as J,N as Se,f as De,L as X,P as Ne,Q as D,q as Z}from"./index-6d832126.js";import{d as C,p as Pe,h as Ee,a as i,c as ze,w as Le}from"./components-9ac8aa63.js";import{u as Te}from"./index-c894909e.js";import{t as _}from"./elements-e3fd99e5.js";import{e as Ae}from"./logger-525ef361.js";const Oe={modelValue:{default:void 0},multiple:Boolean,offsetY:{type:[String,Number],default:0},chip:Boolean,readonly:Boolean,separator:{type:String,default:","},textAlign:{type:String,default:"left"},validateTrigger:{type:Array,default:()=>["onChange","onClear","onClose"]},rules:Array,onFocus:C(),onBlur:C(),onClose:C(),onChange:C(),onClear:C(),"onUpdate:modelValue":C(),...Pe(Ce,["size","variant","placeholder","line","hint","textColor","focusColor","blurColor","disabled","clearable","onClick"])},{name:Ue,n:Ye,classes:Ie}=ze("select"),Re=ge({name:Ue,components:{VarIcon:ve,VarMenu:pe,VarChip:be,VarFieldDecorator:he,VarFormDetails:ye},props:Oe,setup(e){const s=p(!1),k=p(!1),U=c(()=>e.multiple),Y=c(()=>e.focusColor),M=p(""),w=p([]),N=c(()=>$(e.modelValue)),P=c(()=>e.disabled||e.readonly?"":"pointer"),h=p(0),{bindForm:E,form:l}=Ve(),{length:x,options:m,bindOptions:ee}=Te(),{errorMessage:I,validateWithTrigger:le,validate:ae,resetValidation:z}=Ee(),oe=p(null),ne=c(()=>e.variant==="outlined"?"bottom":"cover-top"),se=c(()=>{const{hint:o,blurColor:a,focusColor:n}=e;if(!o)return I.value?"var(--field-decorator-error-color)":s.value?n||"var(--field-decorator-focus-color)":a||"var(--field-decorator-blur-color)"}),re=c(()=>!e.hint&&$(e.modelValue)),R={multiple:U,focusColor:Y,computeLabel:W,onSelect:ue,reset:Q,validate:K,resetValidation:z};A(()=>e.multiple,()=>{const{multiple:o,modelValue:a}=e;o&&!ke(a)&&Ae("Select","The modelValue must be an array when multiple is true")}),A(()=>e.modelValue,q,{deep:!0}),A(()=>x.value,q),ee(R),i(E,R);function W(){const{multiple:o,modelValue:a}=e;if(o){const n=a;w.value=n.map(j)}!o&&!$(a)&&(M.value=j(a)),!o&&$(a)&&(M.value="")}function v(o){Me(()=>{const{validateTrigger:a,rules:n,modelValue:r}=e;le(a,o,n,r)})}function F({value:o,label:a}){return o.value!=null?o.value:a.value}function j(o){let a=m.find(({value:n})=>n.value===o);return a||(a=m.find(({label:n})=>n.value===o)),(a==null?void 0:a.label.value)??""}function ie(){const{disabled:o,readonly:a,onFocus:n}=e;l!=null&&l.disabled.value||l!=null&&l.readonly.value||o||a||(h.value=_(e.offsetY),s.value=!0,i(n),v("onFocus"))}function te(){const{disabled:o,readonly:a,onBlur:n}=e;l!=null&&l.disabled.value||l!=null&&l.readonly.value||o||a||(L(),i(n),v("onBlur"))}function ue(o){const{disabled:a,readonly:n,multiple:r,onChange:y}=e;if(l!=null&&l.disabled.value||l!=null&&l.readonly.value||a||n)return;const d=r?m.filter(({selected:B})=>B.value).map(F):F(o);i(e["onUpdate:modelValue"],d),i(y,d),v("onChange"),r||L()}function de(){const{disabled:o,readonly:a,multiple:n,clearable:r,onClear:y}=e;if(l!=null&&l.disabled.value||l!=null&&l.readonly.value||o||a||!r)return;const d=n?[]:void 0;i(e["onUpdate:modelValue"],d),i(y,d),v("onClear")}function ce(o){const{disabled:a,onClick:n}=e;l!=null&&l.disabled.value||a||(i(n,o),v("onClick"))}function fe(o){const{disabled:a,readonly:n,modelValue:r,onClose:y}=e;if(l!=null&&l.disabled.value||l!=null&&l.readonly.value||a||n)return;const d=r,B=m.find(({label:T})=>T.value===o),G=d.filter(T=>T!==(B.value.value??B.label.value));i(e["onUpdate:modelValue"],G),i(y,G),v("onClose")}function q(){const{multiple:o,modelValue:a}=e;if(o){const n=a;m.forEach(r=>r.sync(n.includes(F(r))))}else m.forEach(n=>n.sync(a===F(n)));W()}function me(){h.value=_(e.offsetY),s.value=!0,k.value=!0}function L(){s.value=!1,k.value=!1}function K(){return ae(e.rules,e.modelValue)}function Q(){i(e["onUpdate:modelValue"],e.multiple?[]:void 0),z()}return{offsetY:h,isFocus:s,showMenu:k,errorMessage:I,formDisabled:l==null?void 0:l.disabled,formReadonly:l==null?void 0:l.readonly,label:M,labels:w,isEmptyModelValue:N,menuEl:oe,placement:ne,cursor:P,placeholderColor:se,enableCustomPlaceholder:re,n:Ye,classes:Ie,handleFocus:ie,handleBlur:te,handleClear:de,handleClick:ce,handleClose:fe,reset:Q,validate:K,resetValidation:z,focus:me,blur:L}}});const We={key:1};function je(e,s,k,U,Y,M){const w=V("var-chip"),N=V("var-icon"),P=V("var-field-decorator"),h=V("var-menu"),E=V("var-form-details");return u(),f("div",{class:t(e.n()),onClick:s[3]||(s[3]=(...l)=>e.handleFocus&&e.handleFocus(...l))},[S(h,{"var-select-cover":"","same-width":"","close-on-click-reference":"",show:e.showMenu,"onUpdate:show":s[1]||(s[1]=l=>e.showMenu=l),class:t(e.n("menu")),"popover-class":e.variant==="standard"&&e.hint?e.n("--standard-menu-margin"):void 0,"offset-y":e.offsetY,disabled:e.formReadonly||e.readonly||e.formDisabled||e.disabled,placement:e.placement,"default-style":!1,onClickOutside:e.handleBlur},{menu:b(()=>[O("div",{ref:"menuEl",class:t(e.classes(e.n("scroller"),e.n("$-elevation--3")))},[g(e.$slots,"default")],2)]),default:b(()=>[S(P,Fe(Be({value:e.modelValue,size:e.size,variant:e.variant,placeholder:e.placeholder,line:e.line,hint:e.hint,textColor:e.textColor,focusColor:e.focusColor,blurColor:e.blurColor,isFocus:e.isFocus,errorMessage:e.errorMessage,formDisabled:e.formDisabled,disabled:e.disabled,clearable:e.clearable,cursor:e.cursor,onClick:e.handleClick,onClear:e.handleClear})),$e({"append-icon":b(()=>[g(e.$slots,"append-icon")]),default:b(()=>[O("div",{class:t(e.classes(e.n("select"),[e.errorMessage,e.n("--error")],[e.formDisabled||e.disabled,e.n("--disabled")])),style:H({textAlign:e.textAlign,color:e.textColor})},[O("div",{class:t(e.n("label"))},[e.isEmptyModelValue?Z("",!0):g(e.$slots,"selected",{key:0},()=>[e.multiple?(u(),f(J,{key:0},[e.chip?(u(),f("div",{key:0,class:t(e.n("chips"))},[(u(!0),f(J,null,Se(e.labels,l=>(u(),De(w,{class:t(e.n("chip")),"var-select-cover":"",closable:"",size:"small",type:e.errorMessage?"danger":void 0,key:l,onClick:s[0]||(s[0]=X(()=>{},["stop"])),onClose:()=>e.handleClose(l)},{default:b(()=>[Ne(D(l),1)]),_:2},1032,["class","type","onClose"]))),128))],2)):(u(),f("div",{key:1,class:t(e.n("values"))},D(e.labels.join(e.separator)),3))],64)):(u(),f("span",We,D(e.label),1))])],2),e.enableCustomPlaceholder?(u(),f("span",{key:0,class:t(e.classes(e.n("placeholder"),e.n("$--ellipsis"))),style:H({color:e.placeholderColor})},D(e.placeholder),7)):Z("",!0),g(e.$slots,"arrow-icon",{focus:e.showMenu},()=>[S(N,{class:t(e.classes(e.n("arrow"),[e.showMenu,e.n("--arrow-rotate")])),"var-select-cover":"",name:"menu-down",transition:300},null,8,["class"])])],6)]),_:2},[e.$slots["prepend-icon"]?{name:"prepend-icon",fn:b(()=>[g(e.$slots,"prepend-icon")]),key:"0"}:void 0]),1040)]),_:3},8,["show","class","popover-class","offset-y","disabled","placement","onClickOutside"]),S(E,{"error-message":e.errorMessage,onClick:s[2]||(s[2]=X(()=>{},["stop"]))},null,8,["error-message"])],2)}const qe=we(Re,[["render",je]]);Le(qe);export{qe as S};
