import{B as ye}from"./index-d81ce224.js";import{I as be}from"./index-4ab18c29.js";import{v as ke}from"./index-cda465cf.js";import{u as Se}from"./provide-e12df439.js";import{d as Ie,a as $,c as $e,w as Ce}from"./components-0778f26c.js";import{d as Ne,r as h,B as K,b0 as Be,F as U,a8 as ze,aH as Pe,aA as Ee,a4 as V,j as Y,ae as Ae,aB as De,_ as He,b as G,K as Ve,O as Ye,e as g,l as p,m as qe,s as C,t as d,v as J,p as T,w as N,q as y,T as Q,aM as q,aq as Z,M as Fe,N as Le,aN as Me}from"./index-d68c71b8.js";import{a as Re}from"./provide-ac0400e4.js";const We={loop:{type:Boolean,default:!0},autoplay:[String,Number],duration:{type:[String,Number],default:300},initialIndex:{type:[String,Number],default:0},navigation:{type:[Boolean,String],default:!1},indicator:{type:Boolean,default:!0},indicatorColor:String,vertical:Boolean,touchable:{type:Boolean,default:!0},onChange:Ie()},Xe=250,Oe=20,{name:je,n:F,classes:Ke}=$e("swipe"),Ue=Ne({name:je,directives:{Hover:ke},components:{VarButton:ye,VarIcon:be},props:We,setup(e){const r=h(null),o=h(0),L=K(()=>e.vertical),f=h(0),i=h(0),c=h(!1),t=h(0),b=h(!1),{swipeItems:s,bindSwipeItems:k,length:n}=Se(),{popup:M,bindPopup:x}=Re(),{deltaX:_,deltaY:ee,moveX:ae,moveY:ne,offsetX:te,offsetY:le,touching:R,direction:ie,startTime:oe,startTouch:re,moveTouch:ue,endTouch:ve}=Be(),W=K(()=>ie.value===(e.vertical?"vertical":"horizontal"));let X=!1,B=-1;k({size:o,vertical:L}),$(x,null),U(()=>n.value,async()=>{await Y(),A(),w()}),M&&U(()=>M.show.value,async a=>{a?(await Y(),w()):S()}),ze(w),Pe(S),Ee(w);function m(a){return s.find(({index:l})=>l.value===a)}function se(){e.loop&&(i.value>=0&&m(n.value-1).setTranslate(-f.value),i.value<=-(f.value-o.value)&&m(0).setTranslate(f.value),i.value>-(f.value-o.value)&&i.value<0&&(m(n.value-1).setTranslate(0),m(0).setTranslate(0)))}function z(a){const l=Ae(a)?a:Math.floor((i.value-o.value/2)/-o.value),{loop:u}=e;return l<=-1?u?-1:0:l>=n.value?u?n.value:n.value-1:l}function fe(a){const{loop:l}=e;return a===-1?l?n.value-1:0:a===n.value?l?0:n.value-1:a}function P(a){return e.loop?a<0?n.value+a:a>=n.value?a-n.value:a:De(a,0,n.value-1)}async function E(){const a=i.value>=o.value,l=i.value<=-f.value,u=0,v=-(f.value-o.value);c.value=!0,(a||l)&&(c.value=!0,i.value=l?u:v,m(0).setTranslate(0),m(n.value-1).setTranslate(0)),await Y(),c.value=!1}function A(){X||(t.value=P(V(e.initialIndex)),X=!0)}function D(){const{autoplay:a}=e;!a||n.value<=1||(S(),B=window.setTimeout(()=>{H(),D()},V(a)))}function S(){B&&clearTimeout(B)}function O(a){i.value=a,se()}async function ce(a){n.value<=1||!e.touchable||(re(a),S(),await E(),c.value=!0)}function de(a){const{touchable:l,vertical:u}=e;!R.value||!l||(ue(a),W.value&&(a.preventDefault(),O(i.value+(u?ne.value:ae.value))))}function me(){if(!R.value||(ve(),!W.value))return;const{vertical:a,onChange:l}=e,u=a?ee.value<0:_.value<0,v=a?le.value:te.value,I=performance.now()-oe.value<=Xe&&v>=Oe?z(u?t.value+1:t.value-1):z();c.value=!1,O(I*-o.value);const we=t.value;t.value=fe(I),D(),we!==t.value&&$(l,t.value)}function w(){r.value&&(c.value=!0,o.value=e.vertical?r.value.offsetHeight:r.value.offsetWidth,f.value=o.value*n.value,i.value=t.value*-o.value,s.forEach(a=>{a.setTranslate(0)}),D(),setTimeout(()=>{c.value=!1}))}async function H(a){if(n.value<=1)return;A();const{loop:l,onChange:u}=e,v=t.value;if(t.value=P(v+1),(a==null?void 0:a.event)!==!1&&$(u,t.value),await E(),v===n.value-1&&l){m(0).setTranslate(f.value),i.value=n.value*-o.value;return}v!==n.value-1&&(i.value=t.value*-o.value)}async function j(a){if(n.value<=1)return;A();const{loop:l,onChange:u}=e,v=t.value;if(t.value=P(v-1),(a==null?void 0:a.event)!==!1&&$(u,t.value),await E(),v===0&&l){m(n.value-1).setTranslate(-f.value),i.value=o.value;return}v!==0&&(i.value=t.value*-o.value)}function he(a,l){if(n.value<=1||a===t.value)return;a=a<0?0:a,a=a>=n.value?n.value:a;const u=a>t.value?H:j,v=Math.abs(a-t.value);Array.from({length:v}).forEach((Te,I)=>{u({event:I===v-1?l==null?void 0:l.event:!1})})}const ge=a=>{e.navigation==="hover"&&(b.value=a)};function pe(a){return e.navigation!=="hover"?"":e.vertical?F(`--navigation-vertical-${a}-animation`):F(`--navigation-${a}-animation`)}return{length:n,index:t,swipeEl:r,trackSize:f,trackTranslate:i,lockDuration:c,hovering:b,n:F,classes:Ke,handleTouchstart:ce,handleTouchmove:de,handleTouchend:me,next:H,prev:j,to:he,resize:w,toNumber:V,handleHovering:ge,getNavigationAnimation:pe}}});const Ge=["onClick"];function Je(e,r,o,L,f,i){const c=G("var-icon"),t=G("var-button"),b=Ve("hover");return Ye((g(),p("div",{class:d(e.n()),ref:"swipeEl"},[qe("div",{class:d(e.classes(e.n("track"),[e.vertical,e.n("--vertical")])),style:J({width:e.vertical?void 0:`${e.trackSize}px`,height:e.vertical?`${e.trackSize}px`:void 0,transform:`translate${e.vertical?"Y":"X"}(${e.trackTranslate}px)`,transitionDuration:e.lockDuration?"0ms":`${e.toNumber(e.duration)}ms`}),onTouchstart:r[0]||(r[0]=(...s)=>e.handleTouchstart&&e.handleTouchstart(...s)),onTouchmove:r[1]||(r[1]=(...s)=>e.handleTouchmove&&e.handleTouchmove(...s)),onTouchend:r[2]||(r[2]=(...s)=>e.handleTouchend&&e.handleTouchend(...s))},[C(e.$slots,"default")],38),e.navigation?C(e.$slots,"prev",q(Z({key:0},{index:e.index,length:e.length,prev:e.prev,next:e.next,to:e.to,hovering:e.hovering})),()=>[T(Q,{name:e.getNavigationAnimation("prev")},{default:N(()=>[e.navigation===!0||e.hovering?(g(),p("div",{key:0,class:d(e.classes(e.n("navigation"),e.n("navigation-prev"),[e.vertical,e.n("--navigation-vertical-prev")]))},[T(t,{"var-swipe-cover":"",disabled:!e.loop&&e.index===0,class:d(e.n("navigation-prev-button")),onClick:r[3]||(r[3]=s=>e.prev())},{default:N(()=>[T(c,{"var-swipe-cover":"",class:d(e.n("navigation-prev-button-icon")),name:e.vertical?"chevron-up":"chevron-left"},null,8,["class","name"])]),_:1},8,["disabled","class"])],2)):y("",!0)]),_:1},8,["name"])]):y("",!0),e.navigation?C(e.$slots,"next",q(Z({key:1},{index:e.index,length:e.length,hovering:e.hovering,prev:e.prev,next:e.next,to:e.to})),()=>[T(Q,{name:e.getNavigationAnimation("next")},{default:N(()=>[e.navigation===!0||e.hovering?(g(),p("div",{key:0,class:d(e.classes(e.n("navigation"),e.n("navigation-next"),[e.vertical,e.n("--navigation-vertical-next")]))},[T(t,{"var-swipe-cover":"",class:d(e.n("navigation-next-button")),disabled:!e.loop&&e.index===e.length-1,onClick:r[4]||(r[4]=s=>e.next())},{default:N(()=>[T(c,{"var-swipe-cover":"",class:d(e.n("navigation-next-button-icon")),name:e.vertical?"chevron-down":"chevron-right"},null,8,["class","name"])]),_:1},8,["class","disabled"])],2)):y("",!0)]),_:1},8,["name"])]):y("",!0),C(e.$slots,"indicator",q(Me({index:e.index,length:e.length,hovering:e.hovering,prev:e.prev,next:e.next,to:e.to})),()=>[e.indicator&&e.length?(g(),p("div",{key:0,class:d(e.classes(e.n("indicators"),[e.vertical,e.n("--indicators-vertical")]))},[(g(!0),p(Fe,null,Le(e.length,(s,k)=>(g(),p("div",{class:d(e.classes(e.n("indicator"),[e.index===k,e.n("--indicator-active")],[e.vertical,e.n("--indicator-vertical")])),style:J({background:e.indicatorColor}),key:s,onClick:n=>e.to(k)},null,14,Ge))),128))],2)):y("",!0)])],2)),[[b,e.handleHovering]])}const Qe=He(Ue,[["render",Je]]);Ce(Qe);export{Qe as S,We as p};
