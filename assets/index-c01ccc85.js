import{B as ae}from"./index-327d7143.js";import{I as te}from"./index-664a3459.js";import{F as re,u as le}from"./provide-d4361ef6.js";import{v as ie}from"./index-1c4795f0.js";import{d as se,r as ue,B as G,a1 as o,F as de,aX as S,n as me,_ as ce,b as M,e as ge,l as he,m as H,p as f,w as J,t as z,v as F,O as pe,aY as fe,ao as be}from"./index-4ae51709.js";import{d as b,h as ve,a as u,f as ye,c as Se,w as ze}from"./components-f9e8bc3d.js";import{a as Ce}from"./elements-5741267d.js";const Te={modelValue:{type:[String,Number],default:0},min:[String,Number],max:[String,Number],step:{type:[String,Number],default:1},color:String,inputWidth:[String,Number],inputTextSize:[String,Number],buttonSize:[String,Number],elevation:{type:[Boolean,Number,String],default:!0},decimalLength:[String,Number],disabled:Boolean,readonly:Boolean,disableIncrement:Boolean,disableDecrement:Boolean,disableInput:Boolean,lazyChange:Boolean,incrementButton:{type:Boolean,default:!0},decrementButton:{type:Boolean,default:!0},press:{type:Boolean,default:!0},ripple:{type:Boolean,default:!0},validateTrigger:{type:Array,default:()=>["onInputChange","onLazyChange","onIncrement","onDecrement"]},rules:Array,onBeforeChange:b(),onChange:b(),onIncrement:b(),onDecrement:b(),"onUpdate:modelValue":b()},{n:Be,classes:Ve}=Se("counter"),K=100,Q=600,De=se({name:"VarCounter",components:{VarButton:ae,VarIcon:te,VarFormDetails:re},directives:{Ripple:ie},inheritAttrs:!1,props:Te,setup(e){const d=ue(""),{bindForm:L,form:E}=le(),{errorMessage:$,validateWithTrigger:A,validate:v,resetValidation:m}=ve(),{readonly:s,disabled:r}=E??{};let C,T,B,V;const P=()=>v(e.rules,e.modelValue),y=n=>{me(()=>{const{validateTrigger:a,rules:l,modelValue:i}=e;A(a,n,l,i)})},W=()=>{const{min:n}=e;u(e["onUpdate:modelValue"],n!=null?o(n):0),m()},Z={reset:W,validate:P,resetValidation:m},R=G(()=>{const{max:n,modelValue:a}=e;return n!=null&&o(a)>=o(n)}),Y=G(()=>{const{min:n,modelValue:a}=e;return n!=null&&o(a)<=o(n)}),c=n=>{const{decimalLength:a,max:l,min:i}=e;let t=o(n);return l!=null&&t>o(l)&&(t=o(l)),i!=null&&t<o(i)&&(t=o(i)),n=String(t),a!=null&&(n=t.toFixed(o(a))),n},_=n=>{const{lazyChange:a,onBeforeChange:l}=e,{value:i}=n.target,t=c(i);a?u(l,o(t),D):g(t),y("onInputChange")},O=()=>{const{disabled:n,readonly:a,disableDecrement:l,decrementButton:i,lazyChange:t,step:w,modelValue:I,onDecrement:N,onBeforeChange:U}=e;if(r!=null&&r.value||s!=null&&s.value||n||a||l||!i||Y.value)return;const k=new S(o(I)).minus(new S(o(w))).toString(),h=c(k),p=o(h);u(N,p),t?u(U,p,D):(g(h),y("onDecrement"))},X=()=>{const{disabled:n,readonly:a,disableIncrement:l,incrementButton:i,lazyChange:t,step:w,modelValue:I,onIncrement:N,onBeforeChange:U}=e;if(r!=null&&r.value||s!=null&&s.value||n||a||l||!i||R.value)return;const k=new S(o(I)).plus(new S(o(w))).toString(),h=c(k),p=o(h);u(N,p),t?u(U,p,D):(g(h),y("onIncrement"))},x=()=>{const{press:n,lazyChange:a}=e;!n||a||(V=window.setTimeout(()=>{q()},Q))},ee=()=>{const{press:n,lazyChange:a}=e;!n||a||(B=window.setTimeout(()=>{j()},Q))},ne=()=>{T&&clearTimeout(T),V&&clearTimeout(V)},oe=()=>{C&&clearTimeout(C),B&&clearTimeout(B)},j=()=>{C=window.setTimeout(()=>{X(),j()},K)},q=()=>{T=window.setTimeout(()=>{O(),q()},K)},g=n=>{d.value=n;const a=o(n);u(e["onUpdate:modelValue"],a)},D=n=>{g(c(String(n))),y("onLazyChange")};return u(L,Z),de(()=>e.modelValue,n=>{g(c(String(n))),u(e.onChange,o(n))}),g(c(String(e.modelValue))),{n:Be,classes:Ve,formatElevation:ye,inputValue:d,errorMessage:$,formDisabled:r,formReadonly:s,isMax:R,isMin:Y,validate:P,reset:W,resetValidation:m,handleChange:_,decrement:O,increment:X,pressDecrement:x,pressIncrement:ee,releaseDecrement:ne,releaseIncrement:oe,toSizeUnit:Ce,toNumber:o}}});const we=["inputmode","readonly","disabled"];function Ie(e,d,L,E,$,A){const v=M("var-icon"),m=M("var-button"),s=M("var-form-details");return ge(),he("div",{class:z(e.classes(e.n(),e.n("$--box")))},[H("div",be({class:e.classes(e.n("controller"),e.formatElevation(e.elevation,2),[e.disabled||e.formDisabled,e.n("--disabled")],[e.errorMessage,e.n("--error")]),style:{background:e.color?e.color:void 0}},e.$attrs),[f(m,{class:z(e.classes(e.n("decrement-button"),[!e.decrementButton,e.n("--hidden")],[e.disabled||e.formDisabled,e.n("--not-allowed")])),style:F({width:e.toSizeUnit(e.buttonSize),height:e.toSizeUnit(e.buttonSize)}),round:"","var-counter-cover":"",ripple:e.ripple&&e.decrementButton&&!e.disabled&&!e.formDisabled&&!e.readonly&&!e.formReadonly&&!e.disableDecrement&&!e.isMin,onClick:e.decrement,onTouchstart:e.pressDecrement,onTouchend:e.releaseDecrement,onTouchcancel:e.releaseDecrement},{default:J(()=>[f(v,{name:"minus"})]),_:1},8,["class","style","ripple","onClick","onTouchstart","onTouchend","onTouchcancel"]),pe(H("input",{class:z(e.classes(e.n("input"),[e.disabled||e.formDisabled,e.n("--not-allowed")])),style:F({width:e.toSizeUnit(e.inputWidth),fontSize:e.toSizeUnit(e.inputTextSize)}),inputmode:e.toNumber(e.decimalLength)===0?"numeric":"decimal",readonly:e.readonly||e.formReadonly,disabled:e.disabled||e.formDisabled||e.disableInput,"onUpdate:modelValue":d[0]||(d[0]=r=>e.inputValue=r),onChange:d[1]||(d[1]=(...r)=>e.handleChange&&e.handleChange(...r))},null,46,we),[[fe,e.inputValue]]),f(m,{class:z(e.classes(e.n("increment-button"),[!e.incrementButton,e.n("--hidden")],[e.disabled||e.formDisabled,e.n("--not-allowed")])),style:F({width:e.toSizeUnit(e.buttonSize),height:e.toSizeUnit(e.buttonSize)}),round:"","var-counter-cover":"",ripple:e.ripple&&e.incrementButton&&!e.disabled&&!e.formDisabled&&!e.readonly&&!e.formReadonly&&!e.disableIncrement&&!e.isMax,onClick:e.increment,onTouchstart:e.pressIncrement,onTouchend:e.releaseIncrement,onTouchcancel:e.releaseIncrement},{default:J(()=>[f(v,{name:"plus"})]),_:1},8,["class","style","ripple","onClick","onTouchstart","onTouchend","onTouchcancel"])],16),f(s,{"error-message":e.errorMessage},null,8,["error-message"])],2)}const Ne=ce(De,[["render",Ie]]);ze(Ne);export{Ne as C};
