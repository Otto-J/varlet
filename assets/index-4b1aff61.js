import{d as Y,a as s,w as L,o as x,u as T,n as j,_ as O,f as _,h as $,O as U,M as r,R as v,Q as o,j as I,N as W,aa as F,aC as G,p as M,q as n,S as a,an as t,F as D,P as f,ak as P,al as A}from"./vue-router-547718df.js";import{u as E,b as V,_ as q,c as H,a as Q}from"./index-d39e90ed.js";import{c as J,w as K}from"./logger-9a144f5d.js";import{g as Z}from"./elements-1fb47fa1.js";import{d as ee}from"./index-ea9abee8.js";import{A as m}from"./appType-610d2e23.js";const te={textWatermark:"文字水印",imageWatermark:"图片水印",customGap:"自定义间距",customOffset:"自定义偏移量",customRotate:"自定义旋转角度",fullscreen:"全屏",customContentSlot:"自定义水印内容",switch:"切换"},ae={textWatermark:"Text Watermark",imageWatermark:"Image Watermark",customGap:"Custom Gap",customOffset:"Custom Offset",customRotate:"Custom Rotate",fullscreen:"Fullscreen",customContentSlot:"Watermark Content Slot",switch:"Switch"},{add:B,use:ne,pack:i,packs:Ue,merge:Ie}=E(),re=e=>{Q(e),ne(e)};V("zh-CN",q);V("en-US",H);B("zh-CN",te);B("en-US",ae);const se={width:{type:Number,default:100},height:{type:Number,default:100},content:{type:String},image:{type:String},rotate:{type:Number,default:-22},offsetX:{type:Number,default:0},offsetY:{type:Number,default:0},gapX:{type:Number,default:0},gapY:{type:Number,default:0},zIndex:{type:[Number,String],default:10},opacity:{type:[Number,String],default:.5},fullscreen:{type:Boolean,default:!1},font:{type:Object,default:()=>({fontStyle:"normal",fontVariant:"normal",fontFamily:"sans-serif",fontWeight:"normal",fontSize:14})}},{n:oe,classes:le}=J("watermark"),fe=Y({name:"VarWatermark",props:se,setup(e,{slots:h}){const l=s(""),g=s(""),p=s(null),w=s(null),k=s(""),R=()=>!!(h.content||e.content&&!e.image),N=async()=>new Promise(b=>{const y=document.createElement("canvas"),X=y.getContext("2d"),c=new Image;c.crossOrigin="anonymous",c.referrerPolicy="no-referrer",c.src=e.image,c.onload=()=>{y.width=c.width,y.height=c.height,X.drawImage(c,0,0),b(y.toDataURL())}}),z=b=>{const y=new Blob([b],{type:"image/svg+xml"});return URL.createObjectURL(y)},C=()=>{l.value&&URL.revokeObjectURL(l.value)},S=async()=>{k.value=Z(w.value).color,e.image&&(g.value=await N()),await j(),C(),l.value=z(p.value.innerHTML)};return L(()=>[e.image,e.font,e.content,e.height,e.width,e.rotate,e.gapX,e.gapY,e.offsetX,e.offsetY,e.opacity],S,{deep:!0}),x(S),T(C),{n:oe,classes:le,svgRef:p,containerRef:w,watermarkUrl:l,imageUrl:g,textColor:k,showContent:R,resize:S}}});const ie={style:{display:"none"},ref:"svgRef"},ue=["viewBox","width","height"],ce=["width","height"],me=["href","xlink:href","x","y","width","height"];function de(e,h,l,g,p,w){return _(),$("div",{class:W(e.n())},[U(e.$slots,"default"),r("div",{ref:"containerRef",class:W(e.classes(e.n("container"),[e.fullscreen,e.n("--fullscreen")])),style:v({backgroundImage:`url(${e.watermarkUrl})`,zIndex:e.zIndex})},[r("div",ie,[(_(),$("svg",{viewBox:`0 0 ${e.width+e.gapX} ${e.height+e.gapY}`,width:`${e.width+e.gapX}`,height:`${e.height+e.gapY}`,xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",style:v({padding:`0 ${e.gapX}px ${e.gapY}px 0`,opacity:e.opacity})},[e.showContent()?(_(),$("foreignObject",{key:0,x:"0",y:"0",width:e.width,height:e.height},[r("div",{xmlns:"http://www.w3.org/1999/xhtml",style:v({transform:`translate(${e.offsetX}px, ${e.offsetY}px) rotate(${e.rotate}deg)`,transformOrigin:"center"})},[U(e.$slots,"content",{},()=>[r("span",{style:v({...e.font,fontSize:`${e.font.fontSize}px`,color:e.textColor})},o(e.content),5)])],4)],8,ce)):I("",!0),!e.$slots.content&&e.image?(_(),$("image",{key:1,href:e.imageUrl,"xlink:href":e.imageUrl,x:e.offsetX,y:e.offsetY,width:e.width,height:e.height,style:v({transformOrigin:"center",transform:`rotate(${e.rotate}deg)`})},null,12,me)):I("",!0)],12,ue))],512)],6)],2)}const u=O(fe,[["render",de]]);K(u);const d=e=>(P("data-v-47f2dccd"),e=e(),A(),e),he=d(()=>r("div",{class:"watermark-wrapper"},null,-1)),ge=d(()=>r("div",{class:"watermark-wrapper"},null,-1)),pe=d(()=>r("div",{class:"watermark-wrapper"},null,-1)),we=d(()=>r("div",{class:"watermark-wrapper"},null,-1)),ye=d(()=>r("div",{class:"watermark-wrapper"},null,-1)),ke={class:"watermark-wrapper"},ve=d(()=>r("div",{class:"watermark-wrapper"},null,-1)),_e=d(()=>r("span",{style:{"font-size":"20px",color:"#fefefe","text-shadow":"0 0 0.5em #4a7afe, 0 0 0.2em #5c5c5c"}},"Varlet UI",-1)),$e={__name:"index",setup(e){const h=s(!1),l=s(null),g=s(null),p=s(null),w=s(null),k=s(null),R=()=>{h.value=!h.value};return F(re),x(()=>{G(ee,()=>{l.value.resize(),g.value.resize(),p.value.resize(),w.value.resize(),k.value.resize()})}),(N,z)=>{const C=M("var-button");return _(),$(D,null,[n(t(m),null,{default:a(()=>[f(o(t(i).textWatermark),1)]),_:1}),n(t(u),{content:"Varlet",ref_key:"watermarkRef",ref:l},{default:a(()=>[he]),_:1},512),n(t(m),null,{default:a(()=>[f(o(t(i).customGap),1)]),_:1}),n(t(u),{content:"Varlet","gap-x":40,"gap-y":40,ref_key:"watermarkRef2",ref:g},{default:a(()=>[ge]),_:1},512),n(t(m),null,{default:a(()=>[f(o(t(i).customOffset),1)]),_:1}),n(t(u),{content:"Varlet","offset-x":20,"offset-y":20,ref_key:"watermarkRef3",ref:p},{default:a(()=>[pe]),_:1},512),n(t(m),null,{default:a(()=>[f(o(t(i).customRotate),1)]),_:1}),n(t(u),{content:"Varlet",rotate:22,"offset-x":20,"offset-y":20,ref_key:"watermarkRef4",ref:w},{default:a(()=>[we]),_:1},512),n(t(m),null,{default:a(()=>[f(o(t(i).imageWatermark),1)]),_:1}),n(t(u),{width:40,height:40,"gap-x":40,"gap-y":40,"offset-x":10,"offset-y":10,image:"./varlet_icon.png"},{default:a(()=>[ye]),_:1}),n(t(m),null,{default:a(()=>[f(o(t(i).fullscreen),1)]),_:1}),n(t(u),{content:"Varlet UI",fullscreen:h.value,opacity:"0.1","offset-x":10,"offset-y":10,ref_key:"watermarkRef5",ref:k},{default:a(()=>[r("div",ke,[n(C,{type:"primary",onClick:R},{default:a(()=>[f(o(t(i).switch),1)]),_:1})])]),_:1},8,["fullscreen"]),n(t(m),null,{default:a(()=>[f(o(t(i).customContentSlot),1)]),_:1}),n(t(u),{"offset-x":10,"offset-y":10},{content:a(()=>[_e]),default:a(()=>[ve]),_:1})],64)}}},We=O($e,[["__scopeId","data-v-47f2dccd"]]);export{We as default};
