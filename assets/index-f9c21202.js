import{I as A}from"./index-664a3459.js";import{F as E,u as K}from"./provide-d4361ef6.js";import{v as X}from"./index-1c4795f0.js";import{H as j,u as q}from"./index-202c58fb.js";import{v as G}from"./index-b12597d8.js";import{d as B,h as J,a as p,c as Q,w as Y}from"./components-f9e8bc3d.js";import{a as z}from"./elements-5741267d.js";import{d as Z,r as x,a1 as c,n as ee,_ as ae,b as C,K as D,e as S,l as V,m as re,M as oe,N as ne,O as te,v as F,t as f,p as H}from"./index-4ae51709.js";const le={modelValue:{type:[String,Number],default:0},count:{type:[String,Number],default:5},color:String,icon:{type:String,default:"star"},emptyColor:String,emptyIcon:{type:String,default:"star-outline"},size:[String,Number],gap:[String,Number],namespace:String,half:Boolean,halfIcon:{type:String,default:"star-half-full"},disabled:Boolean,disabledColor:String,readonly:Boolean,ripple:{type:Boolean,default:!0},clearable:Boolean,rules:Array,onChange:B(),"onUpdate:modelValue":B()},{n:u}=Q("rate"),se=Z({name:"VarRate",components:{VarIcon:A,VarFormDetails:E,VarHoverOverlay:j},directives:{Ripple:X,Hover:G},props:le,setup(e){const{form:a,bindForm:N}=K(),{errorMessage:y,validateWithTrigger:_,validate:k,resetValidation:s}=J(),{hovering:m}=q(),v=x(-1);let g=Number(e.modelValue);const h=r=>{const{count:o,gap:n}=e;return{color:i(r).color,marginRight:r!==c(o)?z(n):0}},t=r=>{const{name:o,color:n}=i(r);return{[u("content")]:!0,[u("--disabled")]:(a==null?void 0:a.disabled.value)||e.disabled,[u("--error")]:y.value,[u("--primary")]:o!==e.emptyIcon&&!n}},i=r=>{const{modelValue:o,disabled:n,disabledColor:l,color:d,half:$,emptyColor:P,icon:T,halfIcon:W,emptyIcon:L}=e;let b=d;return(n||a!=null&&a.disabled.value)&&(b=l),r<=c(o)?{color:b,name:T}:$&&r<=c(o)+.5?{color:b,name:W}:{color:n||a!=null&&a.disabled.value?l:P,name:L}},U=(r,o)=>{const{half:n,clearable:l}=e,{offsetWidth:d}=o.target;n&&o.offsetX<=Math.floor(d/2)&&(r-=.5),g===r&&l&&(r=0),g=r,p(e["onUpdate:modelValue"],r)},I=()=>k(e.rules,c(e.modelValue)),w=()=>ee(()=>_(["onChange"],"onChange",e.rules,e.modelValue)),M=(r,o)=>{const{readonly:n,disabled:l,onChange:d}=e;n||l||a!=null&&a.disabled.value||a!=null&&a.readonly.value||(U(r,o),p(d,r),w())},O=r=>o=>{v.value=r,m.value=o},R=()=>{p(e["onUpdate:modelValue"],0),s()};return p(N,{reset:R,validate:I,resetValidation:s}),{errorMessage:y,formDisabled:a==null?void 0:a.disabled,formReadonly:a==null?void 0:a.readonly,getStyle:h,getClass:t,getCurrentState:i,handleClick:M,hovering:m,currentHoveringValue:v,createHoverHandler:O,reset:R,validate:I,resetValidation:s,toSizeUnit:z,toNumber:c,n:u}}});const ie=["onClick"];function de(e,a,N,y,_,k){const s=C("var-icon"),m=C("var-hover-overlay"),v=C("var-form-details"),g=D("ripple"),h=D("hover");return S(),V("div",{class:f(e.n("wrap"))},[re("div",{class:f(e.n())},[(S(!0),V(oe,null,ne(e.toNumber(e.count),t=>te((S(),V("div",{key:t,style:F(e.getStyle(t)),class:f(e.getClass(t)),onClick:i=>e.handleClick(t,i)},[H(s,{class:f(e.n("content-icon")),"var-rate-cover":"",transition:0,namespace:e.namespace,name:e.getCurrentState(t).name,style:F({fontSize:e.toSizeUnit(e.size)})},null,8,["class","namespace","name","style"]),H(m,{hovering:e.hovering&&t===e.currentHoveringValue&&!e.disabled&&!e.formDisabled},null,8,["hovering"])],14,ie)),[[g,{disabled:e.formReadonly||e.readonly||e.formDisabled||e.disabled||!e.ripple}],[h,e.createHoverHandler(t),"desktop"]])),128))],2),H(v,{"error-message":e.errorMessage},null,8,["error-message"])],2)}const ce=ae(se,[["render",de]]);Y(ce);export{ce as R};
