import{Z as v,d as ie,a as k,b as Z,w as J,_ as me,f as D,h as z,M as j,N as p,R as K,F as ee,ah as se,Q as L,j as x,r as ne,p as Ue,q as R,S as O,i as Ve,G as Ne,aa as Ae,aC as Pe,an as w,P as Y}from"./vue-router-0425d5ec.js";import{d as q}from"./index-36588e9f.js";import{d as ue,c as de,f as Re,a as le,w as Be}from"./logger-5e844ee5.js";import{b as ce,x as te}from"./elements-844831fb.js";import{d as De}from"./index-a0438c78.js";import{u as ze,b as fe,_ as Le,c as je,a as Fe}from"./index-5b7836e0.js";import{A as G}from"./appType-4f3a4d0c.js";const B=["12","1","2","3","4","5","6","7","8","9","10","11"],U=["00","13","14","15","16","17","18","19","20","21","22","23"],re=["00","05","10","15","20","25","30","35","40","45","50","55"];function qe(e){return["ampm","24hr"].includes(e)}const Ee={modelValue:{type:String},elevation:{type:[Boolean,Number,String],default:!1},color:{type:String},headerColor:{type:String},format:{type:String,default:"ampm",validator:qe},allowedTime:{type:Object},min:{type:String},max:{type:String},useSeconds:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},"onUpdate:modelValue":ue(),onChange:ue()},ve=(e,n)=>e==="24hr"||n==="am",oe=(e,n,C)=>{const d=B.findIndex(s=>v(s)===v(C)),f=ve(e,n)?C:U[d];return{hourStr:f,hourNum:v(f)}},N=e=>{const[n,C,d]=e.split(":");return{hour:v(n),minute:v(C),second:v(d)}},he=e=>{var S,V;const{time:n,format:C,ampm:d,hour:f,max:s,min:o,disableHour:i}=e,{hourStr:F,hourNum:A}=oe(C,d,f);let M=!1,T=!1;if(i.includes(F))return!0;if(s&&!o){const{hour:P,minute:t}=N(s);M=P===A&&n>t}if(!s&&o){const{hour:P,minute:t}=N(o);M=P===A&&n<t}if(s&&o){const{hour:P,minute:t}=N(s),{hour:a,minute:r}=N(o);M=a===A&&n<r||P===A&&n>t}return(S=e.allowedTime)!=null&&S.minutes&&(T=(V=e.allowedTime)==null?void 0:V.minutes(n)),M||T},ye=e=>{var V,P;const{time:n,format:C,ampm:d,hour:f,minute:s,max:o,min:i,disableHour:F}=e,{hourStr:A,hourNum:M}=oe(C,d,f);let T=!1,S=!1;if(F.includes(A))return!0;if(o&&!i){const{hour:t,minute:a,second:r}=N(o);T=t===M&&a<s||a===s&&n>r}if(!o&&i){const{hour:t,minute:a,second:r}=N(i);T=t===M&&a>s||a===s&&n>r}if(o&&i){const{hour:t,minute:a,second:r}=N(o),{hour:l,minute:y,second:H}=N(i);T=t===M&&a<s||l===M&&y>s||t===M&&a===s&&n>r||l===M&&y===s&&n<H}return(V=e.allowedTime)!=null&&V.seconds&&(S=(P=e.allowedTime)==null?void 0:P.seconds(n)),T||S},{n:Oe,classes:Xe}=de("time-picker"),Ye=ie({name:"Clock",props:{isInner:{type:Boolean,required:!0},rad:{type:Number},format:{type:String,default:"ampm"},allowedTime:{type:Object},time:{type:Object,required:!0},useSeconds:{type:Boolean,default:!1},preventNextUpdate:{type:Boolean,default:!1},type:{type:String,default:"hour"},ampm:{type:String,default:"am"},color:{type:String},min:{type:String},max:{type:String}},emits:["update","change-prevent-update"],setup(e,{emit:n}){const C=k(null),d=k([]),f=k([]),s=Z(()=>({transform:`rotate(${v(e.rad)}deg)`,height:e.isInner&&e.type==="hour"?"calc(50% - 40px)":"calc(50% - 4px)",backgroundColor:A(),borderColor:A()})),o=Z(()=>{if(e.rad===void 0)return;const t=e.rad/30;return t>=0?t:t+12}),i=Z(()=>e.type==="hour"?B:re),F=(t,a)=>{t=t??(e.type==="minute"?e.time.minute:e.time.second);const r=e.type==="minute"?he:ye,l={time:v(t),format:e.format,ampm:e.ampm,hour:e.time.hour,minute:v(e.time.minute),max:e.max,min:e.min,allowedTime:e.allowedTime,disableHour:d.value};return a&&e.type==="minute"&&Reflect.deleteProperty(l,"minute"),r(l)},A=()=>{if(o.value===void 0)return e.color;const t=e.isInner?U[o.value]:i.value[o.value];return i.value===re?F()?"#bdbdbd":e.color:T(t)?"#bdbdbd":e.color},M=(t,a)=>a?o.value===t&&e.isInner:o.value===t&&(!e.isInner||e.type!=="hour"),T=t=>{if(e.type==="hour"){if(ve(e.format,e.ampm))return d.value.includes(t);const a=B.findIndex(r=>r===t);return f.value.includes(a)}return F(t,!0)},S=(t,a,r)=>{const l=2*Math.PI/12*t-Math.PI/2,y=50*(1+Math.cos(l)),H=50*(1+Math.sin(l)),h=()=>M(t,r)?T(a)?{backgroundColor:"#bdbdbd",color:"#fff"}:{backgroundColor:e.color,color:void 0}:{backgroundColor:void 0,color:void 0},{backgroundColor:I,color:_}=h();return{left:`${y}%`,top:`${H}%`,backgroundColor:I,color:_}},V=()=>{const{width:t,height:a}=ce(C.value);return{width:t,height:a}},P=()=>{if(o.value===void 0)return;const t=e.ampm==="am"?B:U;return te(t[o.value],2,"0")};return J([o,()=>e.isInner],([t,a],[r,l])=>{if(t===r&&a===l||e.type!=="hour"||o.value===void 0)return;const H=a?U[o.value]:P(),h=e.useSeconds?`:${e.time.second}`:"",I=`${H}:${e.time.minute}${h}`;e.preventNextUpdate||n("update",I),n("change-prevent-update")}),J(()=>e.rad,(t,a)=>{if(e.type==="hour"||t===void 0||a===void 0)return;const r=t/6>=0?t/6:t/6+60,l=a/6>=0?a/6:a/6+60;if(r===l)return;let y;const{hourStr:H}=oe(e.format,e.ampm,e.time.hour);if(e.type==="minute"){const h=q().minute(r).format("mm"),I=e.useSeconds?`:${e.time.second}`:"";y=`${H}:${h}${I}`}if(e.type==="second"){const h=q().second(r).format("ss"),I=e.useSeconds?`:${h}`:"";y=`${H}:${e.time.minute}${I}`}n("update",y)}),J([()=>e.max,()=>e.min,()=>e.allowedTime],([t,a,r])=>{if(d.value=[],t&&!a){const{hour:l}=N(t),y=B.filter(h=>v(h)>l),H=U.filter(h=>v(h)>l);d.value=[...y,...H]}if(!t&&a){const{hour:l}=N(a),y=B.filter(h=>v(h)<l),H=U.filter(h=>v(h)<l);d.value=[...y,...H]}if(t&&a){const{hour:l}=N(t),{hour:y}=N(a),H=B.filter(I=>v(I)<y||v(I)>l),h=U.filter(I=>v(I)<y||v(I)>l);d.value=[...H,...h]}if(r!=null&&r.hours){const{hours:l}=r,y=B.filter(h=>!l(v(h))),H=U.filter(h=>!l(v(h)));d.value=[...new Set([...d.value,...y,...H])]}f.value=d.value.map(l=>U.findIndex(y=>l===y)).filter(l=>l>=0)},{immediate:!0}),{n:Oe,classes:Xe,hours24:U,timeScales:i,inner:C,handStyle:s,disableHour:d,isActive:M,isDisable:T,getSize:V,getStyle:S,activeItemIndex:o}}});function Ge(e,n,C,d,f,s){return D(),z("div",{class:p(e.n("clock"))},[j("div",{class:p(e.n("clock-hand")),style:K(e.handStyle)},null,6),(D(!0),z(ee,null,se(e.timeScales,(o,i)=>(D(),z("div",{class:p(e.classes(e.n("clock-item"),[e.isActive(i,!1),e.n("clock-item--active")],[e.isDisable(o),e.n("clock-item--disable")])),key:o,style:K(e.getStyle(i,o,!1))},L(o),7))),128)),e.format==="24hr"&&e.type==="hour"?(D(),z("div",{key:0,class:p(e.n("clock-inner")),ref:"inner"},[(D(!0),z(ee,null,se(e.hours24,(o,i)=>(D(),z("div",{class:p(e.classes(e.n("clock-item"),[e.isActive(i,!0),e.n("clock-item--active")],[e.isDisable(o),e.n("clock-item--disable")])),key:o,style:K(e.getStyle(i,o,!0))},L(o),7))),128))],2)):x("",!0)],2)}const Qe=me(Ye,[["render",Ge]]),{n:We,classes:Ze}=de("time-picker"),Je=ie({name:"VarTimePicker",components:{Clock:Qe},props:Ee,setup(e){const n=k(null),C=k(null),d=k(null),f=k(!1),s=k(!1),o=k(!1),i=k(!1),F=k(!1),A=k(void 0),M=k(0),T=k(0),S=k("hour"),V=k("am"),P=k(!1),t=k(!1),a=k({hour:"00",minute:"00",second:"00"}),r=ne({x:0,y:0}),l=ne({x:[],y:[]}),y=Z(()=>S.value==="hour"?A.value:S.value==="minute"?M.value:T.value),H=u=>{le(e["onUpdate:modelValue"],u),le(e.onChange,u)},h=u=>u*57.29577951308232,I=u=>{i.value=!1,t.value=!1,S.value=u},_=u=>{const{disableHour:m}=d.value,c=B.findIndex(b=>v(b)===v(a.value.hour)),g=u==="am"?B:U;return[...g.slice(c),...g.slice(0,c)].find((b,E)=>(s.value=E!==0,!m.includes(b)))},be=u=>{if(e.readonly)return;V.value=u;const m=_(u);if(!m)return;const c=e.useSeconds?`:${a.value.second}`:"",g=`${te(m,2,"0")}:${a.value.minute}${c}`;H(g)},ae=(u,m)=>{const c=u>=l.x[0]&&u<=l.x[1],g=m>=l.y[0]&&m<=l.y[1];return c&&g},Se=u=>{const m=e.format==="24hr"?"HH":"hh",{hour:c,minute:g,second:$}=N(u);return{hour:q().hour(c).format(m),minute:q().minute(g).format("mm"),second:q().second($).format("ss")}},He=u=>{const m=u/30;return m>=0?m:m+12},ke=()=>{const{width:u,height:m}=d.value.getSize(),c=r.x-u/2-8,g=r.x+u/2+8,$=r.y-m/2-8,b=r.y+m/2+8;return{rangeXMin:c,rangeXMax:g,rangeYMin:$,rangeYMax:b}},Me=(u,m,c)=>{const{disableHour:g}=d.value;o.value=ae(u,m);const $=Math.round(c/30)*30+90,b=He($),E=f.value?B[b]:U[b];if(g.includes(E)||(f.value=e.format==="24hr"?ae(u,m):!1),f.value!==o.value)return;const W=f.value||V.value==="pm"?U[b]:B[b];P.value=g.includes(W),!P.value&&(A.value=$,i.value=!0)},$e=u=>{const{disableHour:m}=d.value,c=Math.round(u/6)*6+90,$={time:c/6>=0?c/6:c/6+60,format:e.format,ampm:V.value,hour:a.value.hour,max:e.max,min:e.min,disableHour:m,allowedTime:e.allowedTime};t.value=he($),!t.value&&(M.value=c,F.value=!0)},we=u=>{const{disableHour:m}=d.value,c=Math.round(u/6)*6+90,$={time:c/6>=0?c/6:c/6+60,format:e.format,ampm:V.value,hour:a.value.hour,minute:v(a.value.minute),max:e.max,min:e.min,disableHour:m,allowedTime:e.allowedTime};ye($)||(T.value=c)},Ce=()=>{const{left:u,top:m,width:c,height:g}=ce(n.value);if(r.x=u+c/2,r.y=m+g/2,S.value==="hour"&&e.format==="24hr"){const{rangeXMin:$,rangeXMax:b,rangeYMin:E,rangeYMax:W}=ke();l.x=[$,b],l.y=[E,W]}},pe=u=>{if(u.preventDefault(),e.readonly)return;Ce();const{clientX:m,clientY:c}=u.touches[0],g=m-r.x,$=c-r.y,b=Math.round(h(Math.atan2($,g)));S.value==="hour"?Me(m,c,b):S.value==="minute"?$e(b):we(b)},Te=()=>{if(!e.readonly){if(S.value==="hour"&&i.value){S.value="minute";return}S.value==="minute"&&e.useSeconds&&F.value&&(S.value="second")}},Ie=()=>{s.value=!1};return J(()=>e.modelValue,u=>{if(u){const{hour:m,minute:c,second:g}=N(u),$=q().hour(m).format("hh"),b=q().hour(m).format("HH"),E=q().minute(c).format("mm"),W=q().second(g).format("ss");A.value=($==="12"?0:v($))*30,M.value=v(E)*6,T.value=v(W)*6,a.value=Se(u),e.format!=="24hr"&&(V.value=te(`${m}`,2,"0")===b&&U.includes(b)?"pm":"am"),f.value=e.format==="24hr"&&U.includes(b)}},{immediate:!0}),{n:We,classes:Ze,getRad:y,time:a,container:n,inner:d,picker:C,isInner:f,type:S,ampm:V,isPreventNextUpdate:s,moveHand:pe,checkPanel:I,checkAmpm:be,end:Te,update:H,changePreventUpdate:Ie,formatElevation:Re}}});const Ke=j("span",null,":",-1),xe={key:0};function _e(e,n,C,d,f,s){const o=Ue("clock");return D(),z("div",{class:p(e.classes(e.n(),e.formatElevation(e.elevation,2))),ref:"picker"},[j("div",{class:p(e.n("title")),style:K({background:e.headerColor||e.color})},[j("div",{class:p(e.n("title-time"))},[j("div",{class:p(e.classes(e.n("title-btn"),[e.type==="hour",e.n("title-btn--active")])),onClick:n[0]||(n[0]=i=>e.checkPanel("hour"))},L(e.time.hour),3),Ke,j("div",{class:p(e.classes(e.n("title-btn"),[e.type==="minute",e.n("title-btn--active")])),onClick:n[1]||(n[1]=i=>e.checkPanel("minute"))},L(e.time.minute),3),e.useSeconds?(D(),z("span",xe,":")):x("",!0),e.useSeconds?(D(),z("div",{key:1,class:p(e.classes(e.n("title-btn"),[e.type==="second",e.n("title-btn--active")])),onClick:n[2]||(n[2]=i=>e.checkPanel("second"))},L(e.time.second),3)):x("",!0)],2),e.format==="ampm"?(D(),z("div",{key:0,class:p(e.n("title-ampm"))},[j("div",{class:p(e.classes(e.n("title-btn"),[e.ampm==="am",e.n("title-btn--active")])),onClick:n[3]||(n[3]=i=>e.checkAmpm("am"))},"AM",2),j("div",{class:p(e.classes(e.n("title-btn"),[e.ampm==="pm",e.n("title-btn--active")])),onClick:n[4]||(n[4]=i=>e.checkAmpm("pm"))},"PM",2)],2)):x("",!0)],6),j("div",{class:p(e.n("body"))},[j("div",{class:p(e.n("clock-container")),onTouchstart:n[5]||(n[5]=(...i)=>e.moveHand&&e.moveHand(...i)),onTouchmove:n[6]||(n[6]=(...i)=>e.moveHand&&e.moveHand(...i)),onTouchend:n[7]||(n[7]=(...i)=>e.end&&e.end(...i)),ref:"container"},[R(Ne,{name:`${e.n()}-panel-fade`},{default:O(()=>[(D(),Ve(o,{key:e.type,ref:"inner",type:e.type,ampm:e.ampm,color:e.color,"is-inner":e.isInner,format:e.format,"allowed-time":e.allowedTime,rad:e.getRad,time:e.time,"prevent-next-update":e.isPreventNextUpdate,"use-seconds":e.useSeconds,max:e.max,min:e.min,onUpdate:e.update,onChangePreventUpdate:e.changePreventUpdate},null,8,["type","ampm","color","is-inner","format","allowed-time","rad","time","prevent-next-update","use-seconds","max","min","onUpdate","onChangePreventUpdate"]))]),_:1},8,["name"])],34)],2)],2)}const X=me(Je,[["render",_e]]);Be(X);const en={basicUsage:"基本使用",hour24:"24小时格式",readonly:"只读",timeLimit:"时间限制",custom:"自定义",showSecond:"显示秒"},nn={basicUsage:"Basic Usage",hour24:"24hr Format",readonly:"Readonly",timeLimit:"Time Limit",custom:"Custom",showSecond:"show-seconds"},{add:ge,use:tn,pack:Q,packs:cn,merge:fn}=ze(),on=e=>{Fe(e),tn(e)};fe("zh-CN",Le);fe("en-US",je);ge("zh-CN",en);ge("en-US",nn);const vn={__name:"index",setup(e){const n=ne({date:"11:20",date1:"15:10",date2:"07:10",date3:"07:10:12",date4:"05:10",date5:"17:36:22"}),C={hours:f=>f%2===0,minutes:f=>f%15!==0,seconds:f=>f%2!==0};function d(f){console.log(f)}return Ae(on),Pe(De),(f,s)=>(D(),z(ee,null,[R(w(G),null,{default:O(()=>[Y(L(w(Q).basicUsage),1)]),_:1}),R(w(X),{modelValue:n.date,"onUpdate:modelValue":s[0]||(s[0]=o=>n.date=o)},null,8,["modelValue"]),R(w(G),null,{default:O(()=>[Y(L(w(Q).hour24),1)]),_:1}),R(w(X),{modelValue:n.date1,"onUpdate:modelValue":s[1]||(s[1]=o=>n.date1=o),format:"24hr",elevation:""},null,8,["modelValue"]),R(w(G),null,{default:O(()=>[Y(L(w(Q).showSecond),1)]),_:1}),R(w(X),{modelValue:n.date5,"onUpdate:modelValue":s[2]||(s[2]=o=>n.date5=o),format:"24hr","use-seconds":""},null,8,["modelValue"]),R(w(G),null,{default:O(()=>[Y(L(w(Q).readonly),1)]),_:1}),R(w(X),{modelValue:n.date2,"onUpdate:modelValue":s[3]||(s[3]=o=>n.date2=o),readonly:"",elevation:""},null,8,["modelValue"]),R(w(G),null,{default:O(()=>[Y(L(w(Q).timeLimit),1)]),_:1}),R(w(X),{modelValue:n.date3,"onUpdate:modelValue":s[4]||(s[4]=o=>n.date3=o),format:"24hr","use-seconds":"",min:"2:28:38",max:"19:40:22","allowed-time":C},null,8,["modelValue"]),R(w(G),null,{default:O(()=>[Y(L(w(Q).custom),1)]),_:1}),R(w(X),{modelValue:n.date4,"onUpdate:modelValue":s[5]||(s[5]=o=>n.date4=o),elevation:"","header-color":"purple",color:"#7bb872",min:"2:28:38",max:"19:40:22",onChange:d},null,8,["modelValue"])],64))}};export{vn as default};
