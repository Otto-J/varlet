import{u as ee}from"./provide-7d2d7f74.js";import{v as ae,e as te}from"./elements-dde26fa0.js";import{d as ne,c as le,a as b}from"./logger-577c0317.js";import{d as re,a as T,b as oe,w as ue,v as se,Z as P,X as ie,aI as ve,_ as ce,f as I,h as k,M as fe,O as q,N as C,R as j,F as de,ai as me,j as he}from"./vue-router-60af08e5.js";import{o as pe}from"./onSmartUnmounted-3d5cf283.js";import{o as Te}from"./onWindowResize-7ba952ef.js";const ge={loop:{type:Boolean,default:!0},autoplay:{type:[String,Number]},duration:{type:[String,Number],default:300},initialIndex:{type:[String,Number],default:0},indicator:{type:Boolean,default:!0},indicatorColor:{type:String},vertical:{type:Boolean,default:!1},touchable:{type:Boolean,default:!0},onChange:ne()},we=250,Se=20,{n:ye,classes:be}=le("swipe"),Ie=re({name:"VarSwipe",props:ge,setup(e){const v=T(null),s=T(0),R=oe(()=>e.vertical),c=T(0),u=T(0),i=T(!1),l=T(0),{swipeItems:$,bindSwipeItems:H,length:n}=ee();let W=!1,g=!1,z=-1,w,S,F,m,h;const f=a=>$.find(({index:t})=>t.value===a),O=()=>{e.loop&&(u.value>=0&&f(n.value-1).setTranslate(-c.value),u.value<=-(c.value-s.value)&&f(0).setTranslate(c.value),u.value>-(c.value-s.value)&&u.value<0&&(f(n.value-1).setTranslate(0),f(0).setTranslate(0)))},N=a=>{const t=ie(a)?a:Math.floor((u.value-s.value/2)/-s.value),{loop:r}=e;return t<=-1?r?-1:0:t>=n.value?r?n.value:n.value-1:t},U=a=>{const{loop:t}=e;return a===-1?t?n.value-1:0:a===n.value?t?0:n.value-1:a},D=a=>e.loop?a<0?n.value+a:a>=n.value?a-n.value:a:ve(a,0,n.value-1),E=a=>{const t=u.value>=s.value,r=u.value<=-c.value,o=0,d=-(c.value-s.value);i.value=!0,(t||r)&&(i.value=!0,u.value=r?o:d,f(0).setTranslate(0),f(n.value-1).setTranslate(0)),ae(()=>{i.value=!1,b(a)})},B=()=>{W||(l.value=D(P(e.initialIndex)),W=!0)},X=()=>{const{autoplay:a}=e;!a||n.value<=1||(Y(),z=window.setTimeout(()=>{M(),X()},P(a)))},Y=()=>{z&&clearTimeout(z)},Z=(a,t)=>{if(a>t&&a>10)return"horizontal";if(t>a&&t>10)return"vertical"},G=a=>{if(n.value<=1||!e.touchable)return;const{clientX:t,clientY:r}=a.touches[0];w=t,S=r,F=performance.now(),g=!0,Y(),E(()=>{i.value=!0})},J=a=>{const{touchable:t,vertical:r}=e;if(!g||!t)return;const{clientX:o,clientY:d}=a.touches[0],p=Math.abs(o-w),A=Math.abs(d-S);if(Z(p,A)===(r?"vertical":"horizontal")){a.preventDefault();const _=m!==void 0?o-m:0,x=h!==void 0?d-h:0;m=o,h=d,u.value+=r?x:_,O()}},K=()=>{if(!g)return;const{vertical:a,onChange:t}=e,r=a?h<S:m<w,o=Math.abs(a?S-h:w-m),p=performance.now()-F<=we&&o>=Se?N(r?l.value+1:l.value-1):N();g=!1,i.value=!1,m=void 0,h=void 0,u.value=p*-s.value;const A=l.value;l.value=U(p),X(),A!==l.value&&b(t,l.value)},y=()=>{v.value&&(i.value=!0,s.value=e.vertical?v.value.offsetHeight:v.value.offsetWidth,c.value=s.value*n.value,u.value=l.value*-s.value,$.forEach(a=>{a.setTranslate(0)}),X(),setTimeout(()=>{i.value=!1}))},M=a=>{if(n.value<=1)return;B();const{loop:t,onChange:r}=e,o=l.value;l.value=D(o+1),(a==null?void 0:a.event)!==!1&&b(r,l.value),E(()=>{if(o===n.value-1&&t){f(0).setTranslate(c.value),u.value=n.value*-s.value;return}o!==n.value-1&&(u.value=l.value*-s.value)})},V=a=>{if(n.value<=1)return;B();const{loop:t,onChange:r}=e,o=l.value;l.value=D(o-1),(a==null?void 0:a.event)!==!1&&b(r,l.value),E(()=>{if(o===0&&t){f(n.value-1).setTranslate(-c.value),u.value=s.value;return}o!==0&&(u.value=l.value*-s.value)})},Q=(a,t)=>{if(n.value<=1||a===l.value)return;a=a<0?0:a,a=a>=n.value?n.value:a;const r=a>l.value?M:V,o=Math.abs(a-l.value);Array.from({length:o}).forEach((d,p)=>{r({event:p===o-1?t==null?void 0:t.event:!1})})};return H({size:s,vertical:R}),ue(()=>n.value,async()=>{await te(),B(),y()}),se(y),pe(Y),Te(y),{n:ye,classes:be,length:n,index:l,swipeEl:v,trackSize:c,translate:u,lockDuration:i,handleTouchstart:G,handleTouchmove:J,handleTouchend:K,next:M,prev:V,to:Q,resize:y,toNumber:P}}});const ke=["onClick"];function Ce(e,v,s,R,c,u){return I(),k("div",{class:C(e.n()),ref:"swipeEl"},[fe("div",{class:C(e.classes(e.n("track"),[e.vertical,e.n("--vertical")])),style:j({width:e.vertical?void 0:`${e.trackSize}px`,height:e.vertical?`${e.trackSize}px`:void 0,transform:`translate${e.vertical?"Y":"X"}(${e.translate}px)`,transitionDuration:e.lockDuration?"0ms":`${e.toNumber(e.duration)}ms`}),onTouchstart:v[0]||(v[0]=(...i)=>e.handleTouchstart&&e.handleTouchstart(...i)),onTouchmove:v[1]||(v[1]=(...i)=>e.handleTouchmove&&e.handleTouchmove(...i)),onTouchend:v[2]||(v[2]=(...i)=>e.handleTouchend&&e.handleTouchend(...i))},[q(e.$slots,"default")],38),q(e.$slots,"indicator",{index:e.index,length:e.length},()=>[e.indicator&&e.length?(I(),k("div",{key:0,class:C(e.classes(e.n("indicators"),[e.vertical,e.n("--indicators-vertical")]))},[(I(!0),k(de,null,me(e.length,(i,l)=>(I(),k("div",{class:C(e.classes(e.n("indicator"),[e.index===l,e.n("--indicator-active")],[e.vertical,e.n("--indicator-vertical")])),style:j({background:e.indicatorColor}),key:i,onClick:$=>e.to(l)},null,14,ke))),128))],2)):he("",!0)])],2)}const L=ce(Ie,[["render",Ce]]);L.install=function(e){e.component(L.name,L)};export{L as S,ge as p};
