import{F as $e,u as Ne}from"./provide-22e90bdb.js";import{d as M,k as Ce,a as F,o as He,c as ze,w as ae}from"./logger-ef73fd8d.js";import{H as De,u as le}from"./index-1ed6d2a3.js";import{v as Pe}from"./index-aac16ed9.js";import{m as Te,y as we,b as Le}from"./elements-a3867831.js";import{d as Ee,a as A,r as Me,b as S,Z as o,aA as m,ao as W,X as I,w as oe,e as Oe,n as Ue,_ as Be,p as se,ag as Ae,f as X,h as R,M as g,N as d,R as $,F as We,ai as Ie,ah as Xe,O as Re,D as Ye,q as ie,Q as qe}from"./vue-router-fcc070b4.js";function Qe(e){return["always","normal","never"].includes(e)}var l=(e=>(e.First="1",e.Second="2",e))(l||{});const Ze={modelValue:{type:[Number,Array],default:0},step:{type:[Number,String],default:1},range:{type:Boolean,default:!1},labelVisible:{type:String,default:"normal",validator:Qe},activeColor:{type:String},trackColor:{type:String},thumbColor:{type:String},labelColor:{type:String},labelTextColor:{type:String},trackHeight:{type:[String,Number]},max:{type:[String,Number],default:100},min:{type:[String,Number],default:0},thumbSize:{type:[String,Number]},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},direction:{type:String,default:"horizontal"},rules:{type:Array},onChange:M(),onStart:M(),onEnd:M(),"onUpdate:modelValue":M()},{n:ue,classes:je}=ze("slider"),Ge=Ee({name:"VarSlider",components:{VarFormDetails:$e,VarHoverOverlay:De},directives:{Hover:Pe},props:Ze,setup(e){const{bindForm:z,form:b}=Ne(),{errorMessage:q,validateWithTrigger:Q,validate:Z,resetValidation:D}=Ce(),{hovering:P,handleHovering:T}=le(),{hovering:i,handleHovering:N}=le(),ce=()=>Z(e.rules,e.modelValue),j=()=>({startPosition:0,currentOffset:0,active:!1,percentValue:0}),de=()=>Ue(()=>Q(["onChange"],"onChange",e.rules,e.modelValue)),O=A(null),f=A(0),w=A(!1),a=Me({[l.First]:j(),[l.Second]:j()}),U=S(()=>o(e.max)-o(e.min)),V=S(()=>f.value/U.value*o(e.step)),ve=S(()=>{const{modelValue:t,range:n}=e;let r=[];return n&&m(t)?r=[{value:p(t[0]),enumValue:l.First,text:C(t[0]),hovering:W(P),handleHovering:T},{value:p(t[1]),enumValue:l.Second,text:C(t[1]),hovering:W(i),handleHovering:N}]:I(t)&&(r=[{value:p(t),enumValue:l.First,text:C(t),hovering:W(P),handleHovering:T}]),r}),me=S(()=>{const{activeColor:t,range:n,modelValue:r}=e,s=n&&m(r)?p(Math.min(r[0],r[1])):0,u=n&&m(r)?p(Math.max(r[0],r[1]))-s:p(r);return y.value?{left:"0px",height:`${u}%`,bottom:`${s}%`,background:t}:{top:"0px",width:`${u}%`,left:`${s}%`,background:t}}),h=S(()=>e.disabled||(b==null?void 0:b.disabled.value)),L=S(()=>e.readonly||(b==null?void 0:b.readonly.value)),y=S(()=>e.direction==="vertical");let v;const fe=t=>{const n=t.currentTarget;return n?y.value?f.value-(t.clientY-Le(n).top):t.clientX-we(n):0},he=t=>({[y.value?"bottom":"left"]:`${t.value}%`,zIndex:a[t.enumValue].active?1:void 0}),ge=t=>e.labelVisible==="always"?!0:e.labelVisible==="never"?!1:a[t].active,p=t=>{const{min:n,max:r}=e;return t<o(n)?0:t>o(r)?100:(t-o(n))/U.value*100},C=t=>{if(!I(t))return 0;let n=t;return n<Number(e.min)&&(n=Number(e.min)),n>Number(e.max)&&(n=Number(e.max)),parseInt(`${n}`,10)===n?n:o(n.toPrecision(5))},be=(t,n)=>{h.value||n.handleHovering(t)},G=(t,n)=>{let r=[];const{step:s,range:u,modelValue:c,onChange:H,min:ee}=e,te=o(s),ne=Math.round(t/V.value),E=ne*te+o(ee),ke=a[n].percentValue*te+o(ee);if(a[n].percentValue=ne,u&&m(c)&&(r=n===l.First?[E,c[1]]:[c[0],E]),ke!==E){const re=u?r.map(Fe=>C(Fe)):C(E);F(H,re),F(e["onUpdate:modelValue"],re),de()}},Ve=t=>{if(!e.range)return l.First;const n=a[l.First].percentValue*V.value,r=a[l.Second].percentValue*V.value,s=Math.abs(t-n),u=Math.abs(t-r);return s<=u?l.First:l.Second},ye=()=>{document.addEventListener("touchmove",B,{passive:!1}),document.addEventListener("touchend",k),document.addEventListener("touchcancel",k)},J=()=>{document.removeEventListener("touchmove",B),document.removeEventListener("touchend",k),document.removeEventListener("touchcancel",k)},Se=(t,n)=>{if(f.value||(f.value=O.value.offsetWidth),h.value||(a[n].active=!0),v=n,ye(),h.value||L.value)return;F(e.onStart),w.value=!0;const{clientX:r,clientY:s}=t.touches[0];a[n].startPosition=y.value?s:r},B=t=>{if(t.preventDefault(),h.value||L.value||!w.value)return;const{startPosition:n,currentOffset:r}=a[v],{clientX:s,clientY:u}=t.touches[0];let c=(y.value?n-u:s-n)+r;c<=0?c=0:c>=f.value&&(c=f.value),G(c,v)},k=()=>{J();const{range:t,modelValue:n,onEnd:r,step:s,min:u}=e;if(h.value||(a[v].active=!1),h.value||L.value)return;let c=[];a[v].currentOffset=a[v].percentValue*V.value;const H=a[v].percentValue*o(s)+o(u);t&&m(n)&&(c=v===l.First?[H,n[1]]:[n[0],H]),F(r,t?c:H),w.value=!1},pe=t=>{if(h.value||L.value||t.target.closest(`.${ue("thumb")}`))return;const n=fe(t),r=Ve(n);v=r,G(n,r),k()},K=()=>{const t=o(e.step);return isNaN(t)?(ae("Slider",'type of prop "step" should be Number'),!1):t<0?(ae("Slider",'"step" should be > 0'),!1):!0},_=()=>{const{range:t,modelValue:n}=e;return t&&!m(n)?(console.error('[Varlet] Slider: "modelValue" should be an Array'),!1):!t&&m(n)?(console.error('[Varlet] Slider: "modelValue" should be a Number'),!1):t&&m(n)&&n.length<2?(console.error('[Varlet] Slider: "modelValue" should have two value'),!1):!0},x=(t=e.modelValue,n=o(e.step))=>{const r=s=>{const{min:u,max:c}=e;return s<o(u)?0:s>o(c)?U.value/n:(s-o(u))/n};e.range&&m(t)?(a[l.First].percentValue=r(t[0]),a[l.First].currentOffset=a[l.First].percentValue*V.value,a[l.Second].percentValue=r(t[1]),a[l.Second].currentOffset=a[l.Second].percentValue*V.value):I(t)&&(a[l.First].currentOffset=r(t)*V.value)};return F(z,{reset:()=>{const t=e.range?[0,0]:0;F(e["onUpdate:modelValue"],t),D()},validate:ce,resetValidation:D}),oe([()=>e.modelValue,()=>e.step],([t,n])=>{!K()||!_()||w.value||x(t,o(n))}),oe(f,()=>x()),He(()=>{!K()||!_()||(f.value=O.value[y.value?"offsetHeight":"offsetWidth"])}),Oe(()=>{J()}),{n:ue,classes:je,Thumbs:l,sliderEl:O,getFillStyle:me,isDisabled:h,isVertical:y,thumbStyle:he,errorMessage:q,thumbsProps:a,thumbList:ve,hover:be,multiplySizeUnit:Te,toNumber:o,showLabel:ge,start:Se,move:B,end:k,click:pe}}});const Je=["onTouchstart"];function Ke(e,z,b,q,Q,Z){const D=se("var-hover-overlay"),P=se("var-form-details"),T=Ae("hover");return X(),R("div",{class:d(e.n(e.direction))},[g("div",{class:d(e.classes(e.n(`${e.direction}-block`),[e.isDisabled,e.n("--disabled")],[e.errorMessage,e.n(`${e.direction}--error`)])),ref:"sliderEl",onClick:z[0]||(z[0]=(...i)=>e.click&&e.click(...i))},[g("div",{class:d(e.n(`${e.direction}-track`))},[g("div",{class:d(e.n(`${e.direction}-track-background`)),style:$({background:e.trackColor,height:e.isVertical?"100%":e.multiplySizeUnit(e.trackHeight),width:e.isVertical?e.multiplySizeUnit(e.trackHeight):"100%"})},null,6),g("div",{class:d(e.n(`${e.direction}-track-fill`)),style:$(e.getFillStyle)},null,6)],2),(X(!0),R(We,null,Ie(e.thumbList,i=>(X(),R("div",{class:d(e.n(`${e.direction}-thumb`)),key:i.enumValue,style:$(e.thumbStyle(i)),onTouchstart:Xe(N=>e.start(N,i.enumValue),["stop"])},[Re(e.$slots,"button",{currentValue:i.text},()=>[Ye(g("div",{class:d(e.n(`${e.direction}-thumb-block`)),style:$({background:e.thumbColor})},null,6),[[T,N=>e.hover(N,i),"desktop"]]),g("div",{class:d(e.classes(e.n(`${e.direction}-thumb-ripple`),[e.thumbsProps[i.enumValue].active,e.n(`${e.direction}-thumb-ripple--active`)])),style:$({background:e.thumbsProps[i.enumValue].active?e.thumbColor:void 0})},[ie(D,{hovering:i.hovering},null,8,["hovering"])],6),g("div",{class:d(e.classes(e.n(`${e.direction}-thumb-label`),[e.showLabel(i.enumValue),e.n(`${e.direction}-thumb-label--active`)])),style:$({background:e.labelColor,color:e.labelTextColor,height:e.thumbSize===void 0?e.thumbSize:e.multiplySizeUnit(e.thumbSize,2),width:e.thumbSize===void 0?e.thumbSize:e.multiplySizeUnit(e.thumbSize,2)})},[g("span",null,qe(i.text),1)],6)])],46,Je))),128))],2),ie(P,{"error-message":e.errorMessage,class:d(e.n("form")),"var-slider-cover":""},null,8,["error-message","class"])],2)}const Y=Be(Ge,[["render",Ke]]);Y.install=function(e){e.component(Y.name,Y)};export{Y as S};
