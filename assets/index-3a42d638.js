import{I as Q}from"./index-a00d271a.js";import{b as W,f as D,q as V,o as X}from"./elements-ab6c30e6.js";import{d as $,o as Z,i as G,c as H,a as P}from"./logger-928e8198.js";import{d as J,a as n,b as h,W as K,w as x,X as ee,Z as g,n as ae,_ as M,p as te,f as p,h as A,M as oe,q as se,N as w,R as ne,O as le,aD as re,i as E,S as B,ao as L,ai as ue,P as ce,Q as ie,F as de}from"./vue-router-d12202db.js";import{C as ve}from"./index-df8699b0.js";import{d as fe}from"./index-a0438c78.js";import"./index-92086fe4.js";import"./index-6f0b3011.js";/* empty css               */const me={modelValue:{type:Boolean},disabled:{type:Boolean,default:!1},animationDuration:{type:[Number,String],default:300},successDuration:{type:[Number,String],default:2e3},bgColor:{type:String},successBgColor:{type:String},color:{type:String},successColor:{type:String},target:{type:[String,Object]},onRefresh:$(),"onUpdate:modelValue":$()},{n:O,classes:he}=H("pull-refresh"),Y=150,ge=J({name:"VarPullRefresh",components:{VarIcon:Q},props:me,setup(e){const t=n(0),v=n(null),i=n(null),d=n(0),o=n("-125%"),l=n("arrow-down"),a=n("default"),r=n(!1);let u,f,b=0,y=0;const C=async s=>{if(l.value!==s)return l.value=s,new Promise(c=>{window.setTimeout(c,Y)})},I=h(()=>a.value!=="loading"&&a.value!=="success"&&!e.disabled),U=h(()=>({transform:`translate3d(0px, ${K(o.value)?o.value:`${o.value}px`}, 0px) translate(-50%, 0)`,transition:r.value?`transform ${e.animationDuration}ms`:void 0,background:T.value?e.successBgColor:e.bgColor,color:T.value?e.successColor:e.color})),m=h(()=>Math.abs(2*t.value)),T=h(()=>a.value==="success"),N=s=>{("classList"in u?u:document.body).classList[s](`${O()}--lock`)},q=s=>{if(t.value===0){const{width:c}=W(i.value);t.value=-(c+c*.25)}b=s.touches[0].clientY,y=0,f=D(s.target)},_=s=>{if(!I.value||!f||f!==u&&V(f)>0)return;const c=V(u);if(c>0)return;const R=c===0;y=s.touches[0].clientY-b,R&&y>=0&&s.preventDefault(),a.value!=="pulling"&&(a.value="pulling",d.value=s.touches[0].clientY),R&&ee(o.value)&&o.value>t.value&&N("add");const k=(s.touches[0].clientY-d.value)/2+t.value;o.value=k>=m.value?m.value:k,C(o.value>=m.value*.2?"refresh":"arrow-down")},z=async()=>{I.value&&(r.value=!0,g(o.value)>=m.value*.2?(await C("refresh"),a.value="loading",o.value=m.value*.3,P(e["onUpdate:modelValue"],!0),ae(()=>{P(e.onRefresh)}),N("remove")):(a.value="loosing",l.value="arrow-down",o.value=t.value,setTimeout(()=>{r.value=!1,N("remove")},g(e.animationDuration))),f=null)},F=()=>{u=e.target?X(e.target,"PullRefresh"):D(v.value)},j=()=>{setTimeout(()=>{a.value="default",l.value="arrow-down",r.value=!1},g(e.animationDuration))};return x(()=>e.modelValue,s=>{s===!1&&(r.value=!0,a.value="success",l.value="checkbox-marked-circle",setTimeout(()=>{o.value=t.value,j()},g(e.successDuration)))}),Z(F),G(v,"touchmove",_),{n:O,classes:he,ICON_TRANSITION:Y,refreshStatus:a,freshNode:v,controlNode:i,touchStart:q,touchMove:_,touchEnd:z,iconName:l,controlStyle:U,isSuccess:T}}});function pe(e,t,v,i,d,o){const l=te("var-icon");return p(),A("div",{ref:"freshNode",class:w(e.n()),onTouchstart:t[0]||(t[0]=(...a)=>e.touchStart&&e.touchStart(...a)),onTouchend:t[1]||(t[1]=(...a)=>e.touchEnd&&e.touchEnd(...a)),onTouchcancel:t[2]||(t[2]=(...a)=>e.touchEnd&&e.touchEnd(...a))},[oe("div",{ref:"controlNode",class:w(e.classes(e.n("control"),e.n("$-elevation--2"),[e.isSuccess,e.n("control-success")])),style:ne(e.controlStyle)},[se(l,{name:e.iconName,transition:e.ICON_TRANSITION,class:w(e.classes(e.n("icon"),[e.refreshStatus==="loading",e.n("animation")])),"var-pull-refresh-cover":""},null,8,["name","transition","class"])],6),le(e.$slots,"default")],34)}const S=M(ge,[["render",pe]]);S.install=function(e){e.component(S.name,S)};const Se={__name:"index",setup(e){const t=Array(30).fill("List Item"),v=Array(30).fill("This is new List Item"),i=n(!1),d=n(t);function o(){setTimeout(()=>{d.value=d.value[0]==="List Item"?v:t,i.value=!1},2e3)}return re(fe),(l,a)=>(p(),E(L(S),{onRefresh:o,modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=r=>i.value=r),"success-duration":"2000"},{default:B(()=>[(p(!0),A(de,null,ue(d.value,(r,u)=>(p(),E(L(ve),{key:u,border:""},{default:B(()=>[ce(ie(r+" "+(u+1)),1)]),_:2},1024))),128))]),_:1},8,["modelValue"]))}},De=M(Se,[["__scopeId","data-v-6f15a34c"]]);export{De as default};
