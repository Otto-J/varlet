import{u as se}from"./provide-f083a588.js";import{d as ve,a as p,c as ce,w as fe}from"./components-aeaa916d.js";import{d as de,r as d,B as X,b0 as me,F as q,a8 as he,aH as Te,aA as pe,a4 as N,j as B,ae as we,aB as ge,_ as ye,e as w,l as g,m as Se,s as M,t as y,v as R,M as ke,N as Ie,q as be}from"./index-e417255e.js";import{a as $e}from"./provide-e31994a7.js";const Ce={loop:{type:Boolean,default:!0},autoplay:[String,Number],duration:{type:[String,Number],default:300},initialIndex:{type:[String,Number],default:0},indicator:{type:Boolean,default:!0},indicatorColor:String,vertical:Boolean,touchable:{type:Boolean,default:!0},onChange:ve()},ze=250,Ee=20,{name:Ne,n:Be,classes:Pe}=ce("swipe"),Ae=de({name:Ne,props:Ce,setup(e){const v=d(null),r=d(0),P=X(()=>e.vertical),c=d(0),u=d(0),o=d(!1),n=d(0),{swipeItems:S,bindSwipeItems:H,length:t}=se(),{popup:A,bindPopup:V}=$e(),{deltaX:j,deltaY:O,moveX:U,moveY:G,offsetX:J,offsetY:K,touching:D,direction:Q,startTime:Z,startTouch:_,moveTouch:x,endTouch:ee}=me(),Y=X(()=>Q.value===(e.vertical?"vertical":"horizontal"));let F=!1,k=-1;H({size:r,vertical:P}),p(V,null),q(()=>t.value,async()=>{await B(),C(),m()}),A&&q(()=>A.show.value,async a=>{a?(await B(),m()):h()}),he(m),Te(h),pe(m);function f(a){return S.find(({index:l})=>l.value===a)}function ae(){e.loop&&(u.value>=0&&f(t.value-1).setTranslate(-c.value),u.value<=-(c.value-r.value)&&f(0).setTranslate(c.value),u.value>-(c.value-r.value)&&u.value<0&&(f(t.value-1).setTranslate(0),f(0).setTranslate(0)))}function I(a){const l=we(a)?a:Math.floor((u.value-r.value/2)/-r.value),{loop:i}=e;return l<=-1?i?-1:0:l>=t.value?i?t.value:t.value-1:l}function te(a){const{loop:l}=e;return a===-1?l?t.value-1:0:a===t.value?l?0:t.value-1:a}function b(a){return e.loop?a<0?t.value+a:a>=t.value?a-t.value:a:ge(a,0,t.value-1)}async function $(){const a=u.value>=r.value,l=u.value<=-c.value,i=0,s=-(c.value-r.value);o.value=!0,(a||l)&&(o.value=!0,u.value=l?i:s,f(0).setTranslate(0),f(t.value-1).setTranslate(0)),await B(),o.value=!1}function C(){F||(n.value=b(N(e.initialIndex)),F=!0)}function z(){const{autoplay:a}=e;!a||t.value<=1||(h(),k=window.setTimeout(()=>{E(),z()},N(a)))}function h(){k&&clearTimeout(k)}function L(a){u.value=a,ae()}async function ne(a){t.value<=1||!e.touchable||(_(a),h(),await $(),o.value=!0)}function le(a){const{touchable:l,vertical:i}=e;!D.value||!l||(x(a),Y.value&&(a.preventDefault(),L(u.value+(i?G.value:U.value))))}function ue(){if(!D.value||(ee(),!Y.value))return;const{vertical:a,onChange:l}=e,i=a?O.value<0:j.value<0,s=a?K.value:J.value,T=performance.now()-Z.value<=ze&&s>=Ee?I(i?n.value+1:n.value-1):I();o.value=!1,L(T*-r.value);const ie=n.value;n.value=te(T),z(),ie!==n.value&&p(l,n.value)}function m(){v.value&&(o.value=!0,r.value=e.vertical?v.value.offsetHeight:v.value.offsetWidth,c.value=r.value*t.value,u.value=n.value*-r.value,S.forEach(a=>{a.setTranslate(0)}),z(),setTimeout(()=>{o.value=!1}))}async function E(a){if(t.value<=1)return;C();const{loop:l,onChange:i}=e,s=n.value;if(n.value=b(s+1),(a==null?void 0:a.event)!==!1&&p(i,n.value),await $(),s===t.value-1&&l){f(0).setTranslate(c.value),u.value=t.value*-r.value;return}s!==t.value-1&&(u.value=n.value*-r.value)}async function W(a){if(t.value<=1)return;C();const{loop:l,onChange:i}=e,s=n.value;if(n.value=b(s-1),(a==null?void 0:a.event)!==!1&&p(i,n.value),await $(),s===0&&l){f(t.value-1).setTranslate(-c.value),u.value=r.value;return}s!==0&&(u.value=n.value*-r.value)}function re(a,l){if(t.value<=1||a===n.value)return;a=a<0?0:a,a=a>=t.value?t.value:a;const i=a>n.value?E:W,s=Math.abs(a-n.value);Array.from({length:s}).forEach((oe,T)=>{i({event:T===s-1?l==null?void 0:l.event:!1})})}return{length:t,index:n,swipeEl:v,trackSize:c,trackTranslate:u,lockDuration:o,n:Be,classes:Pe,handleTouchstart:ne,handleTouchmove:le,handleTouchend:ue,next:E,prev:W,to:re,resize:m,toNumber:N}}});const De=["onClick"];function Ye(e,v,r,P,c,u){return w(),g("div",{class:y(e.n()),ref:"swipeEl"},[Se("div",{class:y(e.classes(e.n("track"),[e.vertical,e.n("--vertical")])),style:R({width:e.vertical?void 0:`${e.trackSize}px`,height:e.vertical?`${e.trackSize}px`:void 0,transform:`translate${e.vertical?"Y":"X"}(${e.trackTranslate}px)`,transitionDuration:e.lockDuration?"0ms":`${e.toNumber(e.duration)}ms`}),onTouchstart:v[0]||(v[0]=(...o)=>e.handleTouchstart&&e.handleTouchstart(...o)),onTouchmove:v[1]||(v[1]=(...o)=>e.handleTouchmove&&e.handleTouchmove(...o)),onTouchend:v[2]||(v[2]=(...o)=>e.handleTouchend&&e.handleTouchend(...o))},[M(e.$slots,"default")],38),M(e.$slots,"indicator",{index:e.index,length:e.length,prev:e.prev,next:e.next,to:e.to},()=>[e.indicator&&e.length?(w(),g("div",{key:0,class:y(e.classes(e.n("indicators"),[e.vertical,e.n("--indicators-vertical")]))},[(w(!0),g(ke,null,Ie(e.length,(o,n)=>(w(),g("div",{class:y(e.classes(e.n("indicator"),[e.index===n,e.n("--indicator-active")],[e.vertical,e.n("--indicator-vertical")])),style:R({background:e.indicatorColor}),key:o,onClick:S=>e.to(n)},null,14,De))),128))],2)):be("",!0)])],2)}const Fe=ye(Ae,[["render",Ye]]);fe(Fe);export{Fe as S,Ce as p};
