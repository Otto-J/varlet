import{d as U,g as Z,o as _,c as ee,a as te,w as oe}from"./logger-9a144f5d.js";import{b as O,t as D}from"./elements-1fb47fa1.js";import{a as s,d as ae,r as ne,w as le,aH as P,_ as se,f as ue,i as ie,M as re,O as ce,m as de,T as ve}from"./vue-router-547718df.js";import{o as fe}from"./onWindowResize-4d20ed42.js";function he(e,a){if(e>a)return"horizontal";if(a>e)return"vertical"}function me(){const e=s(0),a=s(0),h=s(0),u=s(0),i=s(0),n=s(0),o=s(0),f=s(0),c=s(0),p=s(0),g=s(),b=s(!1),w=()=>{e.value=0,a.value=0,h.value=0,u.value=0,i.value=0,n.value=0,o.value=0,f.value=0,c.value=0,p.value=0,g.value=void 0,b.value=!1};return{startX:e,startY:a,deltaX:h,deltaY:u,offsetX:i,offsetY:n,moveX:c,moveY:p,direction:g,touching:b,resetTouch:w,startTouch:y=>{w();const{clientX:d,clientY:m}=y.touches[0];e.value=d,a.value=m,o.value=d,f.value=m,b.value=!0},moveTouch:y=>{const{clientX:d,clientY:m}=y.touches[0];h.value=Math.max(d,0)-e.value,u.value=m-a.value,i.value=Math.abs(h.value),n.value=Math.abs(u.value),c.value=d-o.value,p.value=m-f.value,g.value||(g.value=he(i.value,n.value)),o.value=d,f.value=m},endTouch:()=>{b.value=!1}}}const ge={direction:{type:String,default:"xy"},attraction:{type:String},disabled:{type:Boolean,default:!1},boundary:{type:Object,default:()=>({top:0,bottom:0,left:0,right:0})},zIndex:{type:[Number,String],default:90},teleport:{type:[String,Object,Boolean],default:"body"},onClick:U()},{n:be,classes:Te}=ee("drag"),pe=ae({name:"VarDrag",inheritAttrs:!1,props:ge,setup(e,{attrs:a}){const h=s(null),u=s(0),i=s(0),n=ne({top:0,bottom:0,left:0,right:0}),o=s(!1),f=s(!1),c=s(!1),{touching:p,moveX:g,moveY:b,startTouch:w,moveTouch:R,endTouch:S,resetTouch:H}=me(),{disabled:y}=Z();let d=null;const m=t=>{e.disabled||(d&&window.clearTimeout(d),M(),w(t),c.value=!1)},A=async t=>{!p.value||e.disabled||(t.preventDefault(),f.value=!1,o.value=!0,c.value=!0,R(t),e.direction.includes("x")&&(u.value+=g.value),e.direction.includes("y")&&(i.value+=b.value),x())},I=()=>{e.disabled||(S(),f.value=!0,L(),d=window.setTimeout(()=>{c.value=!1}))},j=t=>{c.value||te(e.onClick,t)},M=()=>{const{left:t,top:l}=k();u.value=t,i.value=l},k=()=>{const t=O(h.value),l=O(window),v=t.top-l.top,r=l.bottom-t.bottom,T=t.left-l.left,B=l.right-t.right,{width:X,height:Y}=t,{width:C,height:z}=l;return{top:v,bottom:r,left:T,right:B,width:X,height:Y,halfWidth:X/2,halfHeight:Y/2,windowWidth:C,windowHeight:z}},W=()=>{const t=k(),l=n.left,v=t.windowWidth-n.right-t.width,r=n.top,T=t.windowHeight-n.bottom-t.height;return{minX:l,minY:r,maxX:l<v?v:l,maxY:r<T?T:r}},L=()=>{if(e.attraction==null)return;const{halfWidth:t,halfHeight:l,top:v,bottom:r,left:T,right:B}=k(),{minX:X,minY:Y,maxX:C,maxY:z}=W(),E=T+t-n.left,F=B+t-n.right,G=v+l-n.top,J=r+l-n.bottom,K=E<=F,Q=G<=J;e.attraction.includes("x")&&(u.value=K?X:C),e.attraction.includes("y")&&(i.value=Q?Y:z)},x=()=>{const{minX:t,minY:l,maxX:v,maxY:r}=W();u.value=P(u.value,t,v),i.value=P(i.value,l,r)},N=()=>{const{top:t=0,bottom:l=0,left:v=0,right:r=0}=e.boundary;n.top=D(t),n.bottom=D(l),n.left=D(v),n.right=D(r)},V=()=>{const t=a.style??{};return{...a,style:{...t,top:o.value?0:t.top,left:o.value?0:t.left,right:o.value?"auto":t.right,bottom:o.value?"auto":t.bottom,transform:o.value?`translate(${u.value}px, ${i.value}px)`:t.transform}}},$=()=>{o.value&&(M(),x())},q=()=>{f.value=!1,o.value=!1,c.value=!1,u.value=0,i.value=0,H()};return le(()=>e.boundary,N),fe($),_(()=>{N(),$()}),{drag:h,x:u,y:i,enableTransition:f,dragging:c,teleportDisabled:y,n:be,classes:Te,getAttrs:V,handleTouchstart:m,handleTouchmove:A,handleTouchend:I,handleClick:j,resize:$,reset:q}}});function ye(e,a,h,u,i,n){return ue(),ie(ve,{to:e.teleport===!1?void 0:e.teleport,disabled:e.teleportDisabled||e.teleport===!1},[re("div",de({ref:"drag",class:e.classes(e.n(),e.n("$--box"),[e.enableTransition,e.n("--transition")]),style:{"z-index":e.zIndex},onTouchstart:a[0]||(a[0]=(...o)=>e.handleTouchstart&&e.handleTouchstart(...o)),onTouchmove:a[1]||(a[1]=(...o)=>e.handleTouchmove&&e.handleTouchmove(...o)),onTouchend:a[2]||(a[2]=(...o)=>e.handleTouchend&&e.handleTouchend(...o)),onTouchcancel:a[3]||(a[3]=(...o)=>e.handleTouchend&&e.handleTouchend(...o)),onClick:a[4]||(a[4]=(...o)=>e.handleClick&&e.handleClick(...o))},e.getAttrs()),[ce(e.$slots,"default")],16)],8,["to","disabled"])}const we=se(pe,[["render",ye]]);oe(we);export{we as D};
