import{I as j}from"./index-db0ed10e.js";import{h as q,f as Q,g as W}from"./elements-9ac6e693.js";import{d as D,e as Z,i as G,c as J,a as _}from"./components-092ce17a.js";import{d as K,a as l,b as h,W as X,w as x,n as ee,Z as w,_ as O,p as ae,f as g,h as Y,M as te,q as oe,N as C,R as se,O as ne,aC as le,i as $,S as P,ap as B,ai as re,P as ue,Q as ce,F as ie}from"./vue-router.esm-bundler-1e250ce9.js";import{C as de}from"./index-e537c9c0.js";import{d as ve}from"./index-59604d2c.js";import"./shared-ed6496a2.js";import"./logger-525ef361.js";import"./index-4a101be0.js";import"./index-fecbe149.js";/* empty css               */const fe={modelValue:{type:Boolean},disabled:{type:Boolean,default:!1},animationDuration:{type:[Number,String],default:300},successDuration:{type:[Number,String],default:2e3},bgColor:{type:String},successBgColor:{type:String},color:{type:String},successColor:{type:String},target:{type:[String,Object]},onRefresh:D(),"onUpdate:modelValue":D()},{n:E,classes:me}=J("pull-refresh"),L=150,he=K({name:"VarPullRefresh",components:{VarIcon:j},props:fe,setup(e){let t,i;const s=l(0),u=l(null),d=l(null),v=l(0),a=l("-125%"),r=l("arrow-down"),o=l("default"),f=l(!1);let b=0,S=0;const y=l(!0),I=h(()=>o.value!=="loading"&&o.value!=="success"&&!e.disabled),M=h(()=>({transform:`translate3d(0px, ${X(a.value)?a.value:`${a.value}px`}, 0px) translate(-50%, 0)`,transition:f.value?`transform ${e.animationDuration}ms`:void 0,background:N.value?e.successBgColor:e.bgColor,color:N.value?e.successColor:e.color})),m=h(()=>Math.abs(2*s.value)),N=h(()=>o.value==="success"),A=()=>new Promise(n=>{window.setTimeout(()=>{y.value=!0,n()},L)}),T=n=>{("classList"in t?t:document.body).classList[n](`${E()}--lock`)},U=n=>{if(s.value===0){const{width:c}=d.value.getBoundingClientRect();s.value=-(c+c*.25)}b=n.touches[0].clientY,S=0},R=n=>{if(!I.value)return;const c=q(t);if(c>0)return;const k=c===0;S=n.touches[0].clientY-b,k&&S>=0&&n.preventDefault(),o.value!=="pulling"&&(o.value="pulling",v.value=n.touches[0].clientY),k&&a.value>s.value&&T("add");const V=(n.touches[0].clientY-v.value)/2+s.value;a.value=V>=m.value?m.value:V,a.value>=m.value*.2?(y.value=!1,r.value="refresh",i=A()):r.value="arrow-down"},z=async()=>{I.value&&(f.value=!0,a.value>=m.value*.2?(await i,o.value="loading",a.value=m.value*.3,_(e["onUpdate:modelValue"],!0),ee(()=>{_(e.onRefresh)}),T("remove")):(o.value="loosing",r.value="arrow-down",a.value=s.value,setTimeout(()=>{f.value=!1,T("remove")},w(e.animationDuration))))},F=()=>{t=e.target?Q(e.target,"PullRefresh"):W(u.value)},H=()=>{setTimeout(()=>{o.value="default",r.value="arrow-down",f.value=!1},w(e.animationDuration))};return x(()=>e.modelValue,n=>{n===!1&&(f.value=!0,o.value="success",r.value="checkbox-marked-circle",setTimeout(()=>{a.value=s.value,H()},w(e.successDuration)))}),Z(F),G(u,"touchmove",R),{n:E,classes:me,iconHasChanged:y,ICON_TRANSITION:L,refreshStatus:o,freshNode:u,controlNode:d,touchStart:U,touchMove:R,touchEnd:z,iconName:r,controlStyle:M,isSuccess:N}}});function ge(e,t,i,s,u,d){const v=ae("var-icon");return g(),Y("div",{ref:"freshNode",class:C(e.n()),onTouchstart:t[0]||(t[0]=(...a)=>e.touchStart&&e.touchStart(...a)),onTouchend:t[1]||(t[1]=(...a)=>e.touchEnd&&e.touchEnd(...a)),onTouchcancel:t[2]||(t[2]=(...a)=>e.touchEnd&&e.touchEnd(...a))},[te("div",{ref:"controlNode",class:C(e.classes(e.n("control"),e.n("$-elevation--2"),[e.isSuccess,e.n("control-success")])),style:se(e.controlStyle)},[oe(v,{name:e.iconName,transition:e.ICON_TRANSITION,class:C(e.classes(e.n("icon"),[e.refreshStatus==="loading"&&e.iconHasChanged,e.n("animation")])),"var-pull-refresh-cover":""},null,8,["name","transition","class"])],6),ne(e.$slots,"default")],34)}const p=O(he,[["render",ge]]);p.install=function(e){e.component(p.name,p)};const pe={setup(e){const t=Array(30).fill("List Item"),i=Array(30).fill("This is new List Item"),s=l(!1),u=l(t);function d(){setTimeout(()=>{u.value=u.value[0]==="List Item"?i:t,s.value=!1},2e3)}return le(ve),(v,a)=>(g(),$(B(p),{onRefresh:d,modelValue:s.value,"onUpdate:modelValue":a[0]||(a[0]=r=>s.value=r),"success-duration":"2000"},{default:P(()=>[(g(!0),Y(ie,null,re(u.value,(r,o)=>(g(),$(B(de),{key:o,border:""},{default:P(()=>[ue(ce(r+" "+(o+1)),1)]),_:2},1024))),128))]),_:1},8,["modelValue"]))}},_e=O(pe,[["__scopeId","data-v-6f15a34c"]]);export{_e as default};
