import{F as Ve,u as Se}from"./provide-85a65511.js";import{d as $,i as ye,a as k,b as ke,c as pe}from"./components-1f31a978.js";import{H as Fe,u as ee}from"./index-e869f763.js";import{v as Ne}from"./index-b7841bd6.js";import{m as Ce,o as Te}from"./elements-5fdfb683.js";import{d as He,a as B,r as Pe,b as p,Z as o,ax as v,ap as W,X as E,w as te,n as we,_ as ze,p as re,ag as Le,f as A,h as I,M as h,N as c,R as F,F as De,ai as $e,ah as ae,O as Me,D as Ue,q as ne,Q as Be}from"./vue-router.esm-bundler-23fbfb7d.js";function We(e){return["always","normal","never"].includes(e)}var l=(e=>(e.First="1",e.Second="2",e))(l||{});const Ee={modelValue:{type:[Number,Array],default:0},step:{type:[Number,String],default:1},range:{type:Boolean,default:!1},labelVisible:{type:String,default:"normal",validator:We},activeColor:{type:String},trackColor:{type:String},thumbColor:{type:String},labelColor:{type:String},labelTextColor:{type:String},trackHeight:{type:[String,Number]},max:{type:[String,Number],default:100},min:{type:[String,Number],default:0},thumbSize:{type:[String,Number]},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},rules:{type:Array},onChange:$(),onStart:$(),onEnd:$(),"onUpdate:modelValue":$()},{n:le,classes:Ae}=pe("slider"),Ie=He({name:"VarSlider",components:{VarFormDetails:Ve,VarHoverOverlay:Fe},directives:{Hover:Ne},props:Ee,setup(e){const{bindForm:C,form:f}=Se(),{errorMessage:X,validateWithTrigger:R,validate:q,resetValidation:T}=ye(),{hovering:H,handleHovering:P}=ee(),{hovering:s,handleHovering:d}=ee(),oe=()=>q(e.rules,e.modelValue),Q=()=>({startPosition:0,currentLeft:0,active:!1,percentValue:0}),se=()=>we(()=>R(["onChange"],"onChange",e.rules,e.modelValue)),M=B(null),b=B(0),w=B(!1),n=Pe({[l.First]:Q(),[l.Second]:Q()}),U=p(()=>o(e.max)-o(e.min)),g=p(()=>b.value/U.value*o(e.step)),ie=p(()=>{const{modelValue:t,range:r}=e;let a=[];return r&&v(t)?a=[{value:S(t[0]),enumValue:l.First,text:N(t[0]),hovering:W(H),handleHovering:P},{value:S(t[1]),enumValue:l.Second,text:N(t[1]),hovering:W(s),handleHovering:d}]:E(t)&&(a=[{value:S(t),enumValue:l.First,text:N(t),hovering:W(H),handleHovering:P}]),a}),ue=p(()=>{const{activeColor:t,range:r,modelValue:a}=e,i=r&&v(a)?S(Math.min(a[0],a[1])):0;return{width:`${r&&v(a)?S(Math.max(a[0],a[1]))-i:S(a)}%`,left:`${i}%`,background:t}}),m=p(()=>e.disabled||(f==null?void 0:f.disabled.value)),z=p(()=>e.readonly||(f==null?void 0:f.readonly.value)),ce=t=>e.labelVisible==="always"?!0:e.labelVisible==="never"?!1:n[t].active,S=t=>{const{min:r,max:a}=e;return t<o(r)?0:t>o(a)?100:(t-o(r))/U.value*100},N=t=>{if(!E(t))return 0;let r=t;return r<Number(e.min)&&(r=Number(e.min)),r>Number(e.max)&&(r=Number(e.max)),parseInt(`${r}`,10)===r?r:o(r.toPrecision(5))},de=(t,r)=>{m.value||r.handleHovering(t)},Z=(t,r)=>{let a=[];const{step:i,range:u,modelValue:V,onChange:L,min:y}=e,Y=o(i),_=Math.round(t/g.value),D=_*Y+o(y),be=n[r].percentValue*Y+o(y);if(n[r].percentValue=_,u&&v(V)&&(a=r===l.First?[D,V[1]]:[V[0],D]),be!==D){const x=u?a.map(ge=>N(ge)):N(D);k(L,x),k(e["onUpdate:modelValue"],x),se()}},ve=t=>{if(!e.range)return l.First;const r=n[l.First].percentValue*g.value,a=n[l.Second].percentValue*g.value,i=Math.abs(t-r),u=Math.abs(t-a);return i<=u?l.First:l.Second},me=(t,r)=>{b.value||(b.value=M.value.offsetWidth),m.value||(n[r].active=!0),!(m.value||z.value)&&(k(e.onStart),w.value=!0,n[r].startPosition=t.touches[0].clientX)},he=(t,r)=>{if(m.value||z.value||!w.value)return;let a=t.touches[0].clientX-n[r].startPosition+n[r].currentLeft;a<=0?a=0:a>=b.value&&(a=b.value),Z(a,r)},j=t=>{const{range:r,modelValue:a,onEnd:i,step:u,min:V}=e;if(m.value||(n[t].active=!1),m.value||z.value)return;let L=[];n[t].currentLeft=n[t].percentValue*g.value;const y=n[t].percentValue*o(u)+o(V);r&&v(a)&&(L=t===l.First?[y,a[1]]:[a[0],y]),k(i,r?L:y),w.value=!1},fe=t=>{if(m.value||z.value||t.target.closest(`.${le("thumb")}`))return;const r=t.clientX-Te(t.currentTarget),a=ve(r);Z(r,a),j(a)},G=()=>{const t=o(e.step);return isNaN(t)?(console.warn('[Varlet] Slider: type of prop "step" should be Number'),!1):t<0?(console.warn('[Varlet] Slider: "step" should be > 0'),!1):!0},J=()=>{const{range:t,modelValue:r}=e;return t&&!v(r)?(console.error('[Varlet] Slider: "modelValue" should be an Array'),!1):!t&&v(r)?(console.error('[Varlet] Slider: "modelValue" should be a Number'),!1):t&&v(r)&&r.length<2?(console.error('[Varlet] Slider: "modelValue" should have two value'),!1):!0},K=(t=e.modelValue,r=o(e.step))=>{const a=i=>{const{min:u,max:V}=e;return i<o(u)?0:i>o(V)?U.value/r:(i-o(u))/r};e.range&&v(t)?(n[l.First].percentValue=a(t[0]),n[l.First].currentLeft=n[l.First].percentValue*g.value,n[l.Second].percentValue=a(t[1]),n[l.Second].currentLeft=n[l.Second].percentValue*g.value):E(t)&&(n[l.First].currentLeft=a(t)*g.value)};return k(C,{reset:()=>{const t=e.range?[0,0]:0;k(e["onUpdate:modelValue"],t),T()},validate:oe,resetValidation:T}),te([()=>e.modelValue,()=>e.step],([t,r])=>{!G()||!J()||w.value||K(t,o(r))}),te(b,()=>K()),ke(()=>{!G()||!J()||(b.value=M.value.offsetWidth)}),{n:le,classes:Ae,Thumbs:l,sliderEl:M,getFillStyle:ue,isDisabled:m,errorMessage:X,thumbsProps:n,thumbList:ie,hover:de,multiplySizeUnit:Ce,toNumber:o,showLabel:ce,start:me,move:he,end:j,click:fe}}});const Oe=["onTouchstart","onTouchmove","onTouchend","onTouchcancel"];function Xe(e,C,f,X,R,q){const T=re("var-hover-overlay"),H=re("var-form-details"),P=Le("hover");return A(),I("div",{class:c(e.n())},[h("div",{class:c(e.classes(e.n("block"),[e.isDisabled,e.n("--disabled")],[e.errorMessage,e.n("--error")])),ref:"sliderEl",onClick:C[0]||(C[0]=(...s)=>e.click&&e.click(...s))},[h("div",{class:c(e.n("track"))},[h("div",{class:c(e.n("track-background")),style:F({background:e.trackColor,height:e.multiplySizeUnit(e.trackHeight)})},null,6),h("div",{class:c(e.n("track-fill")),style:F(e.getFillStyle)},null,6)],2),(A(!0),I(De,null,$e(e.thumbList,s=>(A(),I("div",{class:c(e.n("thumb")),key:s.enumValue,style:F({left:`${s.value}%`,zIndex:e.thumbsProps[s.enumValue].active?1:void 0}),onTouchstart:ae(d=>e.start(d,s.enumValue),["stop"]),onTouchmove:ae(d=>e.move(d,s.enumValue),["stop"]),onTouchend:d=>e.end(s.enumValue),onTouchcancel:d=>e.end(s.enumValue)},[Me(e.$slots,"button",{currentValue:s.text},()=>[Ue(h("div",{class:c(e.n("thumb-block")),style:F({background:e.thumbColor})},null,6),[[P,d=>e.hover(d,s),"desktop"]]),h("div",{class:c(e.classes(e.n("thumb-ripple"),[e.thumbsProps[s.enumValue].active,e.n("thumb-ripple--active")])),style:F({background:e.thumbsProps[s.enumValue].active?e.thumbColor:void 0})},[ne(T,{hovering:s.hovering},null,8,["hovering"])],6),h("div",{class:c(e.classes(e.n("thumb-label"),[e.showLabel(s.enumValue),e.n("thumb-label--active")])),style:F({background:e.labelColor,color:e.labelTextColor,height:e.thumbSize===void 0?e.thumbSize:e.multiplySizeUnit(e.thumbSize,2),width:e.thumbSize===void 0?e.thumbSize:e.multiplySizeUnit(e.thumbSize,2)})},[h("span",null,Be(s.text),1)],6)])],46,Oe))),128))],2),ne(H,{"error-message":e.errorMessage,class:c(e.n("form")),"var-slider-cover":""},null,8,["error-message","class"])],2)}const O=ze(Ie,[["render",Xe]]);O.install=function(e){e.component(O.name,O)};export{O as S};
