import{F as pe,u as Ne}from"./provide-c9578a44.js";import{H as Ce,u as _}from"./index-c04efae2.js";import{v as He}from"./index-bbbbb27d.js";import{d as T,h as ze,a as p,c as De,w as Le}from"./components-b04567c7.js";import{m as Pe,f as Te}from"./elements-f44c7012.js";import{w as x}from"./logger-525ef361.js";import{d as we,r as E,B as y,a4 as i,a2 as b,U as M,ae as O,W as Ee,F as ee,ar as Me,b1 as Oe,n as Ue,ah as Be,_ as We,b as te,K as Ie,e as U,l as B,m as S,t as f,v as N,M as Ae,N as Xe,L as Ye,s as Re,O as Ke,p as ne,Q as Qe}from"./index-77bdb56c.js";var l=(e=>(e.First="1",e.Second="2",e))(l||{});const je={modelValue:{type:[Number,Array],default:0},step:{type:[Number,String],default:1},range:Boolean,labelVisible:{type:String,default:"normal"},activeColor:String,trackColor:String,thumbColor:String,labelColor:String,labelTextColor:String,trackHeight:[String,Number],max:{type:[String,Number],default:100},min:{type:[String,Number],default:0},thumbSize:[String,Number],disabled:Boolean,readonly:Boolean,direction:{type:String,default:"horizontal"},rules:Array,onChange:T(),onStart:T(),onEnd:T(),"onUpdate:modelValue":T()},{name:qe,n:re,classes:Ge}=De("slider"),Je=we({name:qe,components:{VarFormDetails:pe,VarHoverOverlay:Ce},directives:{Hover:He},props:je,setup(e){const d=E(0),D=E(null),C=E(!1),L=y(()=>i(e.max)-i(e.min)),V=y(()=>d.value/L.value*i(e.step)),v=y(()=>e.disabled||(m==null?void 0:m.disabled.value)),k=y(()=>e.readonly||(m==null?void 0:m.readonly.value)),h=y(()=>e.direction==="vertical"),{bindForm:s,form:m}=Ne(),{errorMessage:ae,validateWithTrigger:le,validate:ie,resetValidation:W}=ze(),{hovering:I,handleHovering:A}=_(),{hovering:oe,handleHovering:se}=_(),ue=y(()=>{const{modelValue:t,range:n}=e;let r=[];return n&&b(t)?r=[{value:F(t[0]),enumValue:l.First,text:H(t[0]),hovering:M(I),handleHovering:A},{value:F(t[1]),enumValue:l.Second,text:H(t[1]),hovering:M(oe),handleHovering:se}]:O(t)&&(r=[{value:F(t),enumValue:l.First,text:H(t),hovering:M(I),handleHovering:A}]),r}),ce=y(()=>{const{activeColor:t,range:n,modelValue:r}=e,o=n&&b(r)?F(Math.min(r[0],r[1])):0,u=n&&b(r)?F(Math.max(r[0],r[1]))-o:F(r);return h.value?{left:"0px",height:`${u}%`,bottom:`${o}%`,background:t}:{top:"0px",width:`${u}%`,left:`${o}%`,background:t}}),a=Ee({[l.First]:X(),[l.Second]:X()});let g;p(s,{reset:ke,validate:de,resetValidation:W}),ee([()=>e.modelValue,()=>e.step],([t,n])=>{!K()||!Q()||C.value||j(t,i(n))}),ee(d,()=>j()),Me(()=>{!K()||!Q()||(d.value=D.value[h.value?"offsetHeight":"offsetWidth"])}),Oe(()=>{R()});function de(){return ie(e.rules,e.modelValue)}function X(){return{startPosition:0,currentOffset:0,active:!1,percentValue:0}}function ve(){return Ue(()=>le(["onChange"],"onChange",e.rules,e.modelValue))}function me(t){const n=t.currentTarget;return n?h.value?d.value-(t.clientY-Be(n).top):t.clientX-Te(n):0}function fe(t){return{[h.value?"bottom":"left"]:`${t.value}%`,zIndex:a[t.enumValue].active?1:void 0}}function he(t){return e.labelVisible==="always"?!0:e.labelVisible==="never"?!1:a[t].active}function F(t){const{min:n,max:r}=e;return t<i(n)?0:t>i(r)?100:(t-i(n))/L.value*100}function H(t){if(!O(t))return 0;let n=t;return n<Number(e.min)&&(n=Number(e.min)),n>Number(e.max)&&(n=Number(e.max)),parseInt(`${n}`,10)===n?n:i(n.toPrecision(5))}function ge(t,n){v.value||n.handleHovering(t)}function Y(t,n){let r=[];const{step:o,range:u,modelValue:c,onChange:z,min:q}=e,G=i(o),J=Math.round(t/V.value),P=J*G+i(q),Fe=a[n].percentValue*G+i(q);if(a[n].percentValue=J,u&&b(c)&&(r=n===l.First?[P,c[1]]:[c[0],P]),Fe!==P){const Z=u?r.map($e=>H($e)):H(P);p(z,Z),p(e["onUpdate:modelValue"],Z),ve()}}function be(t){if(!e.range)return l.First;const n=a[l.First].percentValue*V.value,r=a[l.Second].percentValue*V.value,o=Math.abs(t-n),u=Math.abs(t-r);return o<=u?l.First:l.Second}function Ve(){document.addEventListener("touchmove",w,{passive:!1}),document.addEventListener("touchend",$),document.addEventListener("touchcancel",$)}function R(){document.removeEventListener("touchmove",w),document.removeEventListener("touchend",$),document.removeEventListener("touchcancel",$)}function Se(t,n){if(d.value||(d.value=D.value.offsetWidth),v.value||(a[n].active=!0),g=n,Ve(),v.value||k.value)return;p(e.onStart),C.value=!0;const{clientX:r,clientY:o}=t.touches[0];a[n].startPosition=h.value?o:r}function w(t){if(t.preventDefault(),v.value||k.value||!C.value)return;const{startPosition:n,currentOffset:r}=a[g],{clientX:o,clientY:u}=t.touches[0];let c=(h.value?n-u:o-n)+r;c<=0?c=0:c>=d.value&&(c=d.value),Y(c,g)}function $(){R();const{range:t,modelValue:n,onEnd:r,step:o,min:u}=e;if(v.value||(a[g].active=!1),v.value||k.value)return;let c=[];a[g].currentOffset=a[g].percentValue*V.value;const z=a[g].percentValue*i(o)+i(u);t&&b(n)&&(c=g===l.First?[z,n[1]]:[n[0],z]),p(r,t?c:z),C.value=!1}function ye(t){if(v.value||k.value||t.target.closest(`.${re("thumb")}`))return;const n=me(t),r=be(n);g=r,Y(n,r),$()}function K(){const t=i(e.step);return isNaN(t)?(x("Slider",'type of prop "step" should be Number'),!1):t<0?(x("Slider",'"step" should be > 0'),!1):!0}function Q(){const{range:t,modelValue:n}=e;return t&&!b(n)?(console.error('[Varlet] Slider: "modelValue" should be an Array'),!1):!t&&b(n)?(console.error('[Varlet] Slider: "modelValue" should be a Number'),!1):t&&b(n)&&n.length<2?(console.error('[Varlet] Slider: "modelValue" should have two value'),!1):!0}function j(t=e.modelValue,n=i(e.step)){const r=o=>{const{min:u,max:c}=e;return o<i(u)?0:o>i(c)?L.value/n:(o-i(u))/n};e.range&&b(t)?(a[l.First].percentValue=r(t[0]),a[l.First].currentOffset=a[l.First].percentValue*V.value,a[l.Second].percentValue=r(t[1]),a[l.Second].currentOffset=a[l.Second].percentValue*V.value):O(t)&&(a[l.First].currentOffset=r(t)*V.value)}function ke(){const t=e.range?[0,0]:0;p(e["onUpdate:modelValue"],t),W()}return{Thumbs:l,sliderEl:D,getFillStyle:ce,isDisabled:v,isVertical:h,errorMessage:ae,thumbsProps:a,thumbList:ue,n:re,classes:Ge,thumbStyle:fe,hover:ge,multiplySizeUnit:Pe,toNumber:i,showLabel:he,start:Se,move:w,end:$,click:ye}}});const Ze=["onTouchstart"];function _e(e,d,D,C,L,V){const v=te("var-hover-overlay"),k=te("var-form-details"),h=Ie("hover");return U(),B("div",{class:f(e.classes(e.n(e.direction),e.n("$--box")))},[S("div",{class:f(e.classes(e.n(`${e.direction}-block`),[e.isDisabled,e.n("--disabled")],[e.errorMessage,e.n(`${e.direction}--error`)])),ref:"sliderEl",onClick:d[0]||(d[0]=(...s)=>e.click&&e.click(...s))},[S("div",{class:f(e.n(`${e.direction}-track`))},[S("div",{class:f(e.n(`${e.direction}-track-background`)),style:N({background:e.trackColor,height:e.isVertical?"100%":e.multiplySizeUnit(e.trackHeight),width:e.isVertical?e.multiplySizeUnit(e.trackHeight):"100%"})},null,6),S("div",{class:f(e.n(`${e.direction}-track-fill`)),style:N(e.getFillStyle)},null,6)],2),(U(!0),B(Ae,null,Xe(e.thumbList,s=>(U(),B("div",{class:f(e.n(`${e.direction}-thumb`)),key:s.enumValue,style:N(e.thumbStyle(s)),onTouchstart:Ye(m=>e.start(m,s.enumValue),["stop"])},[Re(e.$slots,"button",{currentValue:s.text},()=>[Ke(S("div",{class:f(e.n(`${e.direction}-thumb-block`)),style:N({background:e.thumbColor})},null,6),[[h,m=>e.hover(m,s),"desktop"]]),S("div",{class:f(e.classes(e.n(`${e.direction}-thumb-ripple`),[e.thumbsProps[s.enumValue].active,e.n(`${e.direction}-thumb-ripple--active`)])),style:N({background:e.thumbsProps[s.enumValue].active?e.thumbColor:void 0})},[ne(v,{hovering:s.hovering},null,8,["hovering"])],6),S("div",{class:f(e.classes(e.n(`${e.direction}-thumb-label`),[e.showLabel(s.enumValue),e.n(`${e.direction}-thumb-label--active`)])),style:N({background:e.labelColor,color:e.labelTextColor,height:e.thumbSize===void 0?e.thumbSize:e.multiplySizeUnit(e.thumbSize,2),width:e.thumbSize===void 0?e.thumbSize:e.multiplySizeUnit(e.thumbSize,2)})},[S("span",null,Qe(s.text),1)],6)])],46,Ze))),128))],2),ne(k,{"error-message":e.errorMessage,class:f(e.n("form")),"var-slider-cover":""},null,8,["error-message","class"])],2)}const xe=We(Je,[["render",_e]]);Le(xe);export{xe as S};
