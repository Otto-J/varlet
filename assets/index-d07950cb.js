import{u as ee}from"./provide-1811524f.js";import{d as ae,n as te}from"./elements-dc46aa45.js";import{d as ne,i as le,c as re,a as I}from"./components-81cb4df4.js";import{d as oe,a as T,b as se,w as ue,x as ie,y as ve,v as ce,Z as A,X as de,_ as fe,f as C,h as N,M as he,O as W,N as $,R as q,F as me,ai as pe,j as Te}from"./vue-router-26f60498.js";const we={loop:{type:Boolean,default:!0},autoplay:{type:[String,Number]},duration:{type:[String,Number],default:300},initialIndex:{type:[String,Number],default:0},indicator:{type:Boolean,default:!0},indicatorColor:{type:String},vertical:{type:Boolean,default:!1},touchable:{type:Boolean,default:!0},onChange:ne()},ge=250,ye=20,{n:Se,classes:be}=re("swipe"),ke=oe({name:"VarSwipe",props:we,setup(e){const v=T(null),u=T(0),F=se(()=>e.vertical),c=T(0),s=T(0),i=T(!1),l=T(0),{swipeItems:z,bindSwipeItems:O,length:n}=ee();let w=!1,g=!1,D=-1,y,S,R,h,m;const d=a=>z.find(({index:t})=>t.value===a),j=()=>{e.loop&&(s.value>=0&&d(n.value-1).setTranslate(-c.value),s.value<=-(c.value-u.value)&&d(0).setTranslate(c.value),s.value>-(c.value-u.value)&&s.value<0&&(d(n.value-1).setTranslate(0),d(0).setTranslate(0)))},E=a=>{const t=de(a)?a:Math.floor((s.value-u.value/2)/-u.value),{loop:r}=e;return t<=-1?r?-1:0:t>=n.value?r?n.value:n.value-1:t},H=a=>{const{loop:t}=e;return a===-1?t?n.value-1:0:a===n.value?t?0:n.value-1:a},B=a=>{const{loop:t}=e;return a<0?t?n.value-1:0:a>n.value-1?t?0:n.value-1:a},X=a=>{const t=s.value>=u.value,r=s.value<=-c.value,o=0,f=-(c.value-u.value);i.value=!0,(t||r)&&(i.value=!0,s.value=r?o:f,d(0).setTranslate(0),d(n.value-1).setTranslate(0)),te(()=>{i.value=!1,I(a)})},U=()=>{l.value=B(A(e.initialIndex))},Y=()=>{const{autoplay:a}=e;!a||n.value<=1||(b(),D=window.setTimeout(()=>{M(),Y()},A(a)))},b=()=>{D&&clearTimeout(D)},Z=(a,t)=>{if(a>t&&a>10)return"horizontal";if(t>a&&t>10)return"vertical"},G=a=>{if(n.value<=1||!e.touchable)return;const{clientX:t,clientY:r}=a.touches[0];y=t,S=r,R=performance.now(),g=!0,b(),X(()=>{i.value=!0})},J=a=>{const{touchable:t,vertical:r}=e;if(!g||!t)return;const{clientX:o,clientY:f}=a.touches[0],p=Math.abs(o-y),P=Math.abs(f-S);if(Z(p,P)===(r?"vertical":"horizontal")){a.preventDefault();const x=h!==void 0?o-h:0,_=m!==void 0?f-m:0;h=o,m=f,s.value+=r?_:x,j()}},K=()=>{if(!g)return;const{vertical:a,onChange:t}=e,r=a?m<S:h<y,o=Math.abs(a?S-m:y-h),p=performance.now()-R<=ge&&o>=ye?E(r?l.value+1:l.value-1):E();g=!1,i.value=!1,h=void 0,m=void 0,s.value=p*-u.value;const P=l.value;l.value=H(p),Y(),P!==l.value&&I(t,l.value)},k=()=>{v.value&&(i.value=!0,u.value=e.vertical?v.value.offsetHeight:v.value.offsetWidth,c.value=u.value*n.value,s.value=l.value*-u.value,z.forEach(a=>{a.setTranslate(0)}),Y(),setTimeout(()=>{i.value=!1}))},M=a=>{if(n.value<=1)return;w=!0;const{loop:t,onChange:r}=e,o=l.value;l.value=B(o+1),(a==null?void 0:a.event)!==!1&&I(r,l.value),X(()=>{if(o===n.value-1&&t){d(0).setTranslate(c.value),s.value=n.value*-u.value;return}o!==n.value-1&&(s.value=l.value*-u.value)})},V=a=>{if(n.value<=1)return;w=!0;const{loop:t,onChange:r}=e,o=l.value;l.value=B(o-1),(a==null?void 0:a.event)!==!1&&I(r,l.value),X(()=>{if(o===0&&t){d(n.value-1).setTranslate(-c.value),s.value=u.value;return}o!==0&&(s.value=l.value*-u.value)})},Q=(a,t)=>{if(n.value<=1||a===l.value)return;a=a<0?0:a,a=a>=n.value?n.value:a;const r=a>l.value?M:V,o=Math.abs(a-l.value);Array.from({length:o}).forEach((f,p)=>{r({event:p===o-1?t==null?void 0:t.event:!1})})};return O({size:u,vertical:F}),ue(()=>n.value,async()=>{w=!1,await ae(),!w&&U(),k()}),ie(k),ve(b),ce(b),le(()=>window,"resize",k),{n:Se,classes:be,length:n,index:l,swipeEl:v,trackSize:c,translate:s,lockDuration:i,handleTouchstart:G,handleTouchmove:J,handleTouchend:K,next:M,prev:V,to:Q,resize:k,toNumber:A}}});const Ie=["onClick"];function Ce(e,v,u,F,c,s){return C(),N("div",{class:$(e.n()),ref:"swipeEl"},[he("div",{class:$(e.classes(e.n("track"),[e.vertical,e.n("--vertical")])),style:q({width:e.vertical?void 0:`${e.trackSize}px`,height:e.vertical?`${e.trackSize}px`:void 0,transform:`translate${e.vertical?"Y":"X"}(${e.translate}px)`,transitionDuration:e.lockDuration?"0ms":`${e.toNumber(e.duration)}ms`}),onTouchstart:v[0]||(v[0]=(...i)=>e.handleTouchstart&&e.handleTouchstart(...i)),onTouchmove:v[1]||(v[1]=(...i)=>e.handleTouchmove&&e.handleTouchmove(...i)),onTouchend:v[2]||(v[2]=(...i)=>e.handleTouchend&&e.handleTouchend(...i))},[W(e.$slots,"default")],38),W(e.$slots,"indicator",{index:e.index,length:e.length},()=>[e.indicator&&e.length?(C(),N("div",{key:0,class:$(e.classes(e.n("indicators"),[e.vertical,e.n("--indicators-vertical")]))},[(C(!0),N(me,null,pe(e.length,(i,l)=>(C(),N("div",{class:$(e.classes(e.n("indicator"),[e.index===l,e.n("--indicator-active")],[e.vertical,e.n("--indicator-vertical")])),style:q({background:e.indicatorColor}),key:i,onClick:z=>e.to(l)},null,14,Ie))),128))],2)):Te("",!0)])],2)}const L=fe(ke,[["render",Ce]]);L.install=function(e){e.component(L.name,L)};export{L as S,we as p};
