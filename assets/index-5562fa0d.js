import{u as te}from"./provide-16c71a76.js";import{v as le,e as M}from"./elements-1fb47fa1.js";import{d as ne,a as p,c as ue,w as re}from"./logger-9a144f5d.js";import{d as oe,a as d,b as se,w as V,v as ie,Z as B,X as ve,aH as ce,_ as fe,f as w,h as g,M as de,O as X,N as y,R as Y,F as me,ah as he,j as pe}from"./vue-router-547718df.js";import{o as Te}from"./onSmartUnmounted-610a74e1.js";import{o as we}from"./onWindowResize-4d20ed42.js";import{u as ge}from"./useTouch-4ef72608.js";import{a as ye}from"./provide-c650129a.js";const Se={loop:{type:Boolean,default:!0},autoplay:{type:[String,Number]},duration:{type:[String,Number],default:300},initialIndex:{type:[String,Number],default:0},indicator:{type:Boolean,default:!0},indicatorColor:{type:String},vertical:{type:Boolean,default:!1},touchable:{type:Boolean,default:!0},onChange:ne()},Ie=250,ke=20,{n:be,classes:Ce}=ue("swipe"),$e=oe({name:"VarSwipe",props:Se,setup(e){const v=d(null),r=d(0),P=se(()=>e.vertical),c=d(0),u=d(0),o=d(!1),l=d(0),{swipeItems:S,bindSwipeItems:q,length:t}=te(),{popup:D,bindPopup:H}=ye(),{moveX:A,moveY:L,touching:R,direction:j,startTime:O,distance:U,startTouch:Z,moveTouch:G,endTouch:J}=ge();let W=!1,I=-1;const f=a=>S.find(({index:n})=>n.value===a),K=()=>{e.loop&&(u.value>=0&&f(t.value-1).setTranslate(-c.value),u.value<=-(c.value-r.value)&&f(0).setTranslate(c.value),u.value>-(c.value-r.value)&&u.value<0&&(f(t.value-1).setTranslate(0),f(0).setTranslate(0)))},k=a=>{const n=ve(a)?a:Math.floor((u.value-r.value/2)/-r.value),{loop:s}=e;return n<=-1?s?-1:0:n>=t.value?s?t.value:t.value-1:n},Q=a=>{const{loop:n}=e;return a===-1?n?t.value-1:0:a===t.value?n?0:t.value-1:a},b=a=>e.loop?a<0?t.value+a:a>=t.value?a-t.value:a:ce(a,0,t.value-1),C=a=>{const n=u.value>=r.value,s=u.value<=-c.value,i=0,h=-(c.value-r.value);o.value=!0,(n||s)&&(o.value=!0,u.value=s?i:h,f(0).setTranslate(0),f(t.value-1).setTranslate(0)),le(()=>{o.value=!1,p(a)})},$=()=>{W||(l.value=b(B(e.initialIndex)),W=!0)},N=()=>{const{autoplay:a}=e;!a||t.value<=1||(T(),I=window.setTimeout(()=>{z(),N()},B(a)))},T=()=>{I&&clearTimeout(I)},_=a=>{t.value<=1||!e.touchable||(Z(a),T(),C(()=>{o.value=!0}))},x=a=>{const{touchable:n,vertical:s}=e;if(!R.value||!n)return;G(a);const i=s?"vertical":"horizontal";j.value===i&&(a.preventDefault(),u.value+=s?L.value:A.value,K())},ee=()=>{if(!R.value)return;const{vertical:a,onChange:n}=e;J();const s=a?L.value<0:A.value<0,h=performance.now()-O.value<=Ie&&U.value>=ke?k(s?l.value+1:l.value-1):k();o.value=!1,u.value=h*-r.value;const E=l.value;l.value=Q(h),N(),E!==l.value&&p(n,l.value)},m=()=>{v.value&&(o.value=!0,r.value=e.vertical?v.value.offsetHeight:v.value.offsetWidth,c.value=r.value*t.value,u.value=l.value*-r.value,S.forEach(a=>{a.setTranslate(0)}),N(),setTimeout(()=>{o.value=!1}))},z=a=>{if(t.value<=1)return;$();const{loop:n,onChange:s}=e,i=l.value;l.value=b(i+1),(a==null?void 0:a.event)!==!1&&p(s,l.value),C(()=>{if(i===t.value-1&&n){f(0).setTranslate(c.value),u.value=t.value*-r.value;return}i!==t.value-1&&(u.value=l.value*-r.value)})},F=a=>{if(t.value<=1)return;$();const{loop:n,onChange:s}=e,i=l.value;l.value=b(i-1),(a==null?void 0:a.event)!==!1&&p(s,l.value),C(()=>{if(i===0&&n){f(t.value-1).setTranslate(-c.value),u.value=r.value;return}i!==0&&(u.value=l.value*-r.value)})},ae=(a,n)=>{if(t.value<=1||a===l.value)return;a=a<0?0:a,a=a>=t.value?t.value:a;const s=a>l.value?z:F,i=Math.abs(a-l.value);Array.from({length:i}).forEach((h,E)=>{s({event:E===i-1?n==null?void 0:n.event:!1})})};return q({size:r,vertical:P}),p(H,null),V(()=>t.value,async()=>{await M(),$(),m()}),D&&V(()=>D.show.value,async a=>{a?(await M(),m()):T()}),ie(m),Te(T),we(m),{n:be,classes:Ce,length:t,index:l,swipeEl:v,trackSize:c,translate:u,lockDuration:o,handleTouchstart:_,handleTouchmove:x,handleTouchend:ee,next:z,prev:F,to:ae,resize:m,toNumber:B}}});const Ne=["onClick"];function ze(e,v,r,P,c,u){return w(),g("div",{class:y(e.n()),ref:"swipeEl"},[de("div",{class:y(e.classes(e.n("track"),[e.vertical,e.n("--vertical")])),style:Y({width:e.vertical?void 0:`${e.trackSize}px`,height:e.vertical?`${e.trackSize}px`:void 0,transform:`translate${e.vertical?"Y":"X"}(${e.translate}px)`,transitionDuration:e.lockDuration?"0ms":`${e.toNumber(e.duration)}ms`}),onTouchstart:v[0]||(v[0]=(...o)=>e.handleTouchstart&&e.handleTouchstart(...o)),onTouchmove:v[1]||(v[1]=(...o)=>e.handleTouchmove&&e.handleTouchmove(...o)),onTouchend:v[2]||(v[2]=(...o)=>e.handleTouchend&&e.handleTouchend(...o))},[X(e.$slots,"default")],38),X(e.$slots,"indicator",{index:e.index,length:e.length},()=>[e.indicator&&e.length?(w(),g("div",{key:0,class:y(e.classes(e.n("indicators"),[e.vertical,e.n("--indicators-vertical")]))},[(w(!0),g(me,null,he(e.length,(o,l)=>(w(),g("div",{class:y(e.classes(e.n("indicator"),[e.index===l,e.n("--indicator-active")],[e.vertical,e.n("--indicator-vertical")])),style:Y({background:e.indicatorColor}),key:o,onClick:S=>e.to(l)},null,14,Ne))),128))],2)):pe("",!0)])],2)}const Ee=fe($e,[["render",ze]]);re(Ee);export{Ee as S,Se as p};
