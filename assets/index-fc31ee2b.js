import{F as Se,u as ye}from"./provide-2d8aed18.js";import{d as $,i as ke,a as k,b as pe,c as Fe}from"./components-440543a7.js";import{H as Ne,u as ee}from"./index-34c73e6b.js";import{v as Ce}from"./index-d73f18e4.js";import{m as Te,o as He}from"./elements-323d4edc.js";import{d as Pe,a as E,r as we,b as p,Z as s,ax as v,ap as A,X as I,w as te,n as ze,_ as Le,p as re,ag as De,f as M,h as U,M as V,N as d,R as F,F as $e,ai as Me,ah as ae,O as Ue,D as ne,q as le,Q as Be}from"./vue-router.esm-bundler-6be07501.js";function We(e){return["always","normal","never"].includes(e)}var l=(e=>(e.First="1",e.Second="2",e))(l||{});const Ee={modelValue:{type:[Number,Array],default:0},step:{type:[Number,String],default:1},range:{type:Boolean,default:!1},labelVisible:{type:String,default:"normal",validator:We},activeColor:{type:String},trackColor:{type:String},thumbColor:{type:String},labelColor:{type:String},labelTextColor:{type:String},trackHeight:{type:[String,Number]},max:{type:[String,Number],default:100},min:{type:[String,Number],default:0},thumbSize:{type:[String,Number]},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},rules:{type:Array},onChange:$(),onStart:$(),onEnd:$(),"onUpdate:modelValue":$()},{n:oe,classes:Ae}=Fe("slider"),Ie=Pe({name:"VarSlider",components:{VarFormDetails:Se,VarHoverOverlay:Ne},directives:{Hover:Ce},props:Ee,setup(e){const{bindForm:T,form:h}=ye(),{errorMessage:X,validateWithTrigger:R,validate:q,resetValidation:H}=ke(),{hovering:P,handleHovering:N}=ee(),{hovering:o,handleHovering:u}=ee(),se=()=>q(e.rules,e.modelValue),Q=()=>({startPosition:0,currentLeft:0,active:!1,percentValue:0}),ie=()=>ze(()=>R(["onChange"],"onChange",e.rules,e.modelValue)),B=E(null),f=E(0),w=E(!1),n=we({[l.First]:Q(),[l.Second]:Q()}),W=p(()=>s(e.max)-s(e.min)),b=p(()=>f.value/W.value*s(e.step)),ue=p(()=>{const{modelValue:t,range:r}=e;let a=[];return r&&v(t)?a=[{value:S(t[0]),enumValue:l.First,text:C(t[0]),hovering:A(P),handleHovering:N},{value:S(t[1]),enumValue:l.Second,text:C(t[1]),hovering:A(o),handleHovering:u}]:I(t)&&(a=[{value:S(t),enumValue:l.First,text:C(t),hovering:A(P),handleHovering:N}]),a}),ce=p(()=>{const{activeColor:t,range:r,modelValue:a}=e,i=r&&v(a)?S(Math.min(a[0],a[1])):0;return{width:`${r&&v(a)?S(Math.max(a[0],a[1]))-i:S(a)}%`,left:`${i}%`,background:t}}),m=p(()=>e.disabled||(h==null?void 0:h.disabled.value)),z=p(()=>e.readonly||(h==null?void 0:h.readonly.value)),de=t=>e.labelVisible==="always"?!0:e.labelVisible==="never"?!1:n[t].active,S=t=>{const{min:r,max:a}=e;return t<s(r)?0:t>s(a)?100:(t-s(r))/W.value*100},C=t=>{if(!I(t))return 0;let r=t;return r<Number(e.min)&&(r=Number(e.min)),r>Number(e.max)&&(r=Number(e.max)),parseInt(`${r}`,10)===r?r:s(r.toPrecision(5))},ve=(t,r)=>{m.value||r.handleHovering(t)},Z=(t,r)=>{let a=[];const{step:i,range:c,modelValue:g,onChange:L,min:y}=e,Y=s(i),_=Math.round(t/b.value),D=_*Y+s(y),ge=n[r].percentValue*Y+s(y);if(n[r].percentValue=_,c&&v(g)&&(a=r===l.First?[D,g[1]]:[g[0],D]),ge!==D){const x=c?a.map(Ve=>C(Ve)):C(D);k(L,x),k(e["onUpdate:modelValue"],x),ie()}},me=t=>{if(!e.range)return l.First;const r=n[l.First].percentValue*b.value,a=n[l.Second].percentValue*b.value,i=Math.abs(t-r),c=Math.abs(t-a);return i<=c?l.First:l.Second},he=(t,r)=>{f.value||(f.value=B.value.offsetWidth),m.value||(n[r].active=!0),!(m.value||z.value)&&(k(e.onStart),w.value=!0,n[r].startPosition=t.touches[0].clientX)},fe=(t,r)=>{if(m.value||z.value||!w.value)return;let a=t.touches[0].clientX-n[r].startPosition+n[r].currentLeft;a<=0?a=0:a>=f.value&&(a=f.value),Z(a,r)},j=t=>{const{range:r,modelValue:a,onEnd:i,step:c,min:g}=e;if(m.value||(n[t].active=!1),m.value||z.value)return;let L=[];n[t].currentLeft=n[t].percentValue*b.value;const y=n[t].percentValue*s(c)+s(g);r&&v(a)&&(L=t===l.First?[y,a[1]]:[a[0],y]),k(i,r?L:y),w.value=!1},be=t=>{if(m.value||z.value||t.target.closest(`.${oe("thumb")}`))return;const r=t.clientX-He(t.currentTarget),a=me(r);Z(r,a),j(a)},G=()=>{const t=s(e.step);return isNaN(t)?(console.warn('[Varlet] Slider: type of prop "step" should be Number'),!1):t<0?(console.warn('[Varlet] Slider: "step" should be > 0'),!1):!0},J=()=>{const{range:t,modelValue:r}=e;return t&&!v(r)?(console.error('[Varlet] Slider: "modelValue" should be an Array'),!1):!t&&v(r)?(console.error('[Varlet] Slider: "modelValue" should be a Number'),!1):t&&v(r)&&r.length<2?(console.error('[Varlet] Slider: "modelValue" should have two value'),!1):!0},K=(t=e.modelValue,r=s(e.step))=>{const a=i=>{const{min:c,max:g}=e;return i<s(c)?0:i>s(g)?W.value/r:(i-s(c))/r};e.range&&v(t)?(n[l.First].percentValue=a(t[0]),n[l.First].currentLeft=n[l.First].percentValue*b.value,n[l.Second].percentValue=a(t[1]),n[l.Second].currentLeft=n[l.Second].percentValue*b.value):I(t)&&(n[l.First].currentLeft=a(t)*b.value)};return k(T,{reset:()=>{const t=e.range?[0,0]:0;k(e["onUpdate:modelValue"],t),H()},validate:se,resetValidation:H}),te([()=>e.modelValue,()=>e.step],([t,r])=>{!G()||!J()||w.value||K(t,s(r))}),te(f,()=>K()),pe(()=>{!G()||!J()||(f.value=B.value.offsetWidth)}),{n:oe,classes:Ae,Thumbs:l,sliderEl:B,getFillStyle:ce,isDisabled:m,errorMessage:X,thumbsProps:n,thumbList:ue,hover:ve,multiplySizeUnit:Te,toNumber:s,showLabel:de,start:he,move:fe,end:j,click:be}}});const Oe=["onTouchstart","onTouchmove","onTouchend","onTouchcancel"];function Xe(e,T,h,X,R,q){const H=re("var-hover-overlay"),P=re("var-form-details"),N=De("hover");return M(),U("div",{class:d(e.n())},[V("div",{class:d(e.classes(e.n("block"),[e.isDisabled,e.n("--disabled")],[e.errorMessage,e.n("--error")])),ref:"sliderEl",onClick:T[0]||(T[0]=(...o)=>e.click&&e.click(...o))},[V("div",{class:d(e.n("track"))},[V("div",{class:d(e.n("track-background")),style:F({background:e.trackColor,height:e.multiplySizeUnit(e.trackHeight)})},null,6),V("div",{class:d(e.n("track-fill")),style:F(e.getFillStyle)},null,6)],2),(M(!0),U($e,null,Me(e.thumbList,o=>(M(),U("div",{class:d(e.n("thumb")),key:o.enumValue,style:F({left:`${o.value}%`,zIndex:e.thumbsProps[o.enumValue].active?1:void 0}),onTouchstart:ae(u=>e.start(u,o.enumValue),["stop"]),onTouchmove:ae(u=>e.move(u,o.enumValue),["stop"]),onTouchend:u=>e.end(o.enumValue),onTouchcancel:u=>e.end(o.enumValue)},[Ue(e.$slots,"button",{currentValue:o.text},()=>[ne(V("div",{class:d(e.n("thumb-block")),style:F({background:e.thumbColor})},null,6),[[N,u=>e.hover(u,o),"desktop"]]),ne((M(),U("div",{class:d(e.classes(e.n("thumb-ripple"),[e.thumbsProps[o.enumValue].active,e.n("thumb-ripple--active")])),style:F({background:e.thumbsProps[o.enumValue].active?e.thumbColor:void 0})},[le(H,{hovering:o.hovering},null,8,["hovering"])],6)),[[N,u=>e.hover(u,o),"desktop"]]),V("div",{class:d(e.classes(e.n("thumb-label"),[e.showLabel(o.enumValue),e.n("thumb-label--active")])),style:F({background:e.labelColor,color:e.labelTextColor,height:e.thumbSize===void 0?e.thumbSize:e.multiplySizeUnit(e.thumbSize,2),width:e.thumbSize===void 0?e.thumbSize:e.multiplySizeUnit(e.thumbSize,2)})},[V("span",null,Be(o.text),1)],6)])],46,Oe))),128))],2),le(P,{"error-message":e.errorMessage,class:d(e.n("form")),"var-slider-cover":""},null,8,["error-message","class"])],2)}const O=Le(Ie,[["render",Xe]]);O.install=function(e){e.component(O.name,O)};export{O as S};
