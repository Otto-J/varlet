import{I as fe}from"./index-122c3176.js";import{M as pe}from"./index-0bfc56d7.js";import{C as be}from"./index-cdc1ade1.js";import{p as Ce,V as ye}from"./FieldDecorator-8bb6db3f.js";import{F as he,u as Ve}from"./provide-6cf57022.js";import{d as ge,a as V,b as m,aJ as S,w as T,n as ke,aA as Fe,_ as Me,p as g,f as u,h as v,q as $,S as b,M as L,N as i,O as k,aL as we,aM as Se,aK as $e,R as G,F as H,ai as Be,i as De,ah as X,P as Pe,Q as B,j as Z}from"./vue-router-d6817537.js";import{d as C,p as Ae,l as Ee,a as t,c as Ne,e as ze}from"./logger-d47ce557.js";import{u as Te}from"./index-f872ec72.js";import{t as _}from"./elements-16ad11e3.js";function Le(e){return["left","right","center"].includes(e)}const Ue={modelValue:{default:void 0},multiple:{type:Boolean,default:!1},offsetY:{type:[String,Number],default:0},chip:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},separator:{type:String,default:","},textAlign:{type:String,default:"left",validator:Le},validateTrigger:{type:Array,default:()=>["onChange","onClear","onClose"]},rules:{type:Array},onFocus:C(),onBlur:C(),onClose:C(),onChange:C(),onClear:C(),"onUpdate:modelValue":C(),...Ae(Ce,["size","variant","placeholder","line","hint","textColor","focusColor","blurColor","disabled","clearable","onClick"])},{n:Oe,classes:Ye}=Ne("select"),Re=ge({name:"VarSelect",components:{VarIcon:fe,VarMenu:pe,VarChip:be,VarFieldDecorator:ye,VarFormDetails:he},props:Ue,setup(e){const n=V(!1),O=m(()=>e.multiple),Y=m(()=>e.focusColor),F=V(""),D=V([]),P=m(()=>S(e.modelValue)),A=m(()=>e.disabled||e.readonly?"":"pointer"),y=V(0),{bindForm:E,form:l}=Ve(),{length:d,options:f,bindOptions:x}=Te(),{errorMessage:R,validateWithTrigger:ee,validate:le,resetValidation:N}=Ee(),ae=V(null),oe=m(()=>e.variant==="outlined"?"bottom-start":"cover-top-start"),se=m(()=>{const{hint:o,blurColor:a,focusColor:s}=e;if(!o)return R.value?"var(--field-decorator-error-color)":n.value?s||"var(--field-decorator-focus-color)":a||"var(--field-decorator-blur-color)"}),ne=m(()=>!e.hint&&S(e.modelValue)&&!n.value),I=()=>{const{multiple:o,modelValue:a}=e;if(o){const s=a;D.value=s.map(j)}!o&&!S(a)&&(F.value=j(a)),!o&&S(a)&&(F.value="")},p=o=>{ke(()=>{const{validateTrigger:a,rules:s,modelValue:r}=e;ee(a,o,s,r)})},M=({value:o,label:a})=>o.value!=null?o.value:a.value,j=o=>{let a=f.find(({value:s})=>s.value===o);return a||(a=f.find(({label:s})=>s.value===o)),(a==null?void 0:a.label.value)??""},re=()=>{const{disabled:o,readonly:a,onFocus:s}=e;l!=null&&l.disabled.value||l!=null&&l.readonly.value||o||a||(y.value=_(e.offsetY),n.value=!0,t(s),p("onFocus"))},te=()=>{const{disabled:o,readonly:a,onBlur:s}=e;l!=null&&l.disabled.value||l!=null&&l.readonly.value||o||a||(t(s),p("onBlur"))},ie=o=>{const{disabled:a,readonly:s,multiple:r,onChange:h}=e;if(l!=null&&l.disabled.value||l!=null&&l.readonly.value||a||s)return;const c=r?f.filter(({selected:w})=>w.value).map(M):M(o);t(e["onUpdate:modelValue"],c),t(h,c),p("onChange"),!r&&(n.value=!1)},de=()=>{const{disabled:o,readonly:a,multiple:s,clearable:r,onClear:h}=e;if(l!=null&&l.disabled.value||l!=null&&l.readonly.value||o||a||!r)return;const c=s?[]:void 0;t(e["onUpdate:modelValue"],c),t(h,c),p("onClear")},ue=o=>{const{disabled:a,onClick:s}=e;l!=null&&l.disabled.value||a||(t(s,o),p("onClick"))},ce=o=>{const{disabled:a,readonly:s,modelValue:r,onClose:h}=e;if(l!=null&&l.disabled.value||l!=null&&l.readonly.value||a||s)return;const c=r,w=f.find(({label:z})=>z.value===o),Q=c.filter(z=>z!==(w.value.value??w.label.value));t(e["onUpdate:modelValue"],Q),t(h,Q),p("onClose")},W=()=>{const{multiple:o,modelValue:a}=e;if(o){const s=a;f.forEach(r=>r.sync(s.includes(M(r))))}else f.forEach(s=>s.sync(a===M(s)));I()},me=()=>{y.value=_(e.offsetY),n.value=!0},ve=()=>{n.value=!1},q=()=>le(e.rules,e.modelValue),J=()=>{t(e["onUpdate:modelValue"],e.multiple?[]:void 0),N()};T(()=>e.multiple,()=>{const{multiple:o,modelValue:a}=e;o&&!Fe(a)&&ze("Select","The modelValue must be an array when multiple is true")}),T(()=>e.modelValue,W,{deep:!0}),T(()=>d.value,W);const K={multiple:O,focusColor:Y,computeLabel:I,onSelect:ie,reset:J,validate:q,resetValidation:N};return x(K),t(E,K),{offsetY:y,isFocus:n,errorMessage:R,formDisabled:l==null?void 0:l.disabled,formReadonly:l==null?void 0:l.readonly,label:F,labels:D,isEmptyModelValue:P,menuEl:ae,placement:oe,cursor:A,placeholderColor:se,useCustomPlaceholder:ne,n:Oe,classes:Ye,handleFocus:re,handleBlur:te,handleClear:de,handleClick:ue,handleClose:ce,reset:J,validate:q,resetValidation:N,focus:me,blur:ve}}});const Ie={key:1};function je(e,n,O,Y,F,D){const P=g("var-chip"),A=g("var-icon"),y=g("var-field-decorator"),E=g("var-menu"),l=g("var-form-details");return u(),v("div",{class:i(e.n()),onClick:n[3]||(n[3]=(...d)=>e.handleFocus&&e.handleFocus(...d))},[$(E,{class:i(e.n("menu")),"var-select-cover":"","same-width":"","offset-y":e.offsetY,disabled:e.formReadonly||e.readonly||e.formDisabled||e.disabled,placement:e.placement,"default-style":!1,show:e.isFocus,"onUpdate:show":n[1]||(n[1]=d=>e.isFocus=d),onClose:e.handleBlur},{menu:b(()=>[L("div",{ref:"menuEl",class:i(e.classes(e.n("scroller"),e.n(`--scroller-${e.variant}`),e.n("$-elevation--3"),[!e.hint,e.n("--scroller-non-hint")]))},[k(e.$slots,"default")],2)]),default:b(()=>[$(y,we(Se({value:e.modelValue,size:e.size,variant:e.variant,placeholder:e.placeholder,line:e.line,hint:e.hint,textColor:e.textColor,focusColor:e.focusColor,blurColor:e.blurColor,isFocus:e.isFocus,errorMessage:e.errorMessage,formDisabled:e.formDisabled,disabled:e.disabled,clearable:e.clearable,cursor:e.cursor,onClick:e.handleClick,onClear:e.handleClear})),$e({"append-icon":b(()=>[k(e.$slots,"append-icon")]),default:b(()=>[L("div",{class:i(e.classes(e.n("select"),[e.errorMessage,e.n("--error")],[e.formDisabled||e.disabled,e.n("--disabled")])),style:G({textAlign:e.textAlign,color:e.textColor})},[L("div",{class:i(e.n("label"))},[e.isEmptyModelValue?Z("",!0):k(e.$slots,"selected",{key:0},()=>[e.multiple?(u(),v(H,{key:0},[e.chip?(u(),v("div",{key:0,class:i(e.n("chips"))},[(u(!0),v(H,null,Be(e.labels,d=>(u(),De(P,{class:i(e.n("chip")),"var-select-cover":"",closable:"",size:"small",type:e.errorMessage?"danger":void 0,key:d,onClick:n[0]||(n[0]=X(()=>{},["stop"])),onClose:()=>e.handleClose(d)},{default:b(()=>[Pe(B(d),1)]),_:2},1032,["class","type","onClose"]))),128))],2)):(u(),v("div",{key:1,class:i(e.n("values"))},B(e.labels.join(e.separator)),3))],64)):(u(),v("span",Ie,B(e.label),1))])],2),e.useCustomPlaceholder?(u(),v("span",{key:0,class:i(e.classes(e.n("placeholder"),e.n("$--ellipsis"))),style:G({color:e.placeholderColor})},B(e.placeholder),7)):Z("",!0),k(e.$slots,"arrow-icon",{focus:e.isFocus},()=>[$(A,{class:i(e.classes(e.n("arrow"),[e.isFocus,e.n("--arrow-rotate")])),"var-select-cover":"",name:"menu-down",transition:300},null,8,["class"])])],6)]),_:2},[e.$slots["prepend-icon"]?{name:"prepend-icon",fn:b(()=>[k(e.$slots,"prepend-icon")]),key:"0"}:void 0]),1040)]),_:3},8,["class","offset-y","disabled","placement","show","onClose"]),$(l,{"error-message":e.errorMessage,onClick:n[2]||(n[2]=X(()=>{},["stop"]))},null,8,["error-message"])],2)}const U=Me(Re,[["render",je]]);U.install=function(e){e.component(U.name,U)};export{U as S};
