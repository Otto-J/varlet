import{B as me}from"./index-a3b03678.js";import{v as pe}from"./index-bbbbb27d.js";import{u as ge}from"./provide-ce1279ca.js";import{d as Te,a as $,c as we,w as ye}from"./components-b04567c7.js";import{d as ke,r as m,B as O,b0 as Se,F as j,a8 as be,aH as Ie,aA as $e,a4 as Y,j as F,ae as Ce,aB as Be,_ as Ne,b as K,K as ze,O as Ee,e as p,l as g,m as De,s as C,t as d,v as U,p as T,w as B,q as y,T as G,M as Pe,N as He}from"./index-77bdb56c.js";import{a as Ae}from"./provide-07a01a8d.js";const Ye={loop:{type:Boolean,default:!0},autoplay:[String,Number],duration:{type:[String,Number],default:300},initialIndex:{type:[String,Number],default:0},navigation:{type:[Boolean,String],default:!1},indicator:{type:Boolean,default:!0},indicatorColor:String,vertical:Boolean,touchable:{type:Boolean,default:!0},onChange:Te()},Fe=250,Le=20,{name:Ve,n:We,classes:Xe}=we("swipe"),qe=ke({name:Ve,directives:{Hover:pe},components:{VarButton:me},props:Ye,setup(e){const u=m(null),i=m(0),L=O(()=>e.vertical),f=m(0),o=m(0),c=m(!1),t=m(0),k=m(!1),{swipeItems:v,bindSwipeItems:S,length:n}=ge(),{popup:V,bindPopup:J}=Ae(),{deltaX:Q,deltaY:Z,moveX:x,moveY:_,offsetX:ee,offsetY:ae,touching:W,direction:ne,startTime:te,startTouch:le,moveTouch:oe,endTouch:ie}=Se(),X=O(()=>ne.value===(e.vertical?"vertical":"horizontal"));let q=!1,N=-1;S({size:i,vertical:L}),$(J,null),j(()=>n.value,async()=>{await F(),P(),w()}),V&&j(()=>V.show.value,async a=>{a?(await F(),w()):b()}),be(w),Ie(b),$e(w);function h(a){return v.find(({index:l})=>l.value===a)}function ue(){e.loop&&(o.value>=0&&h(n.value-1).setTranslate(-f.value),o.value<=-(f.value-i.value)&&h(0).setTranslate(f.value),o.value>-(f.value-i.value)&&o.value<0&&(h(n.value-1).setTranslate(0),h(0).setTranslate(0)))}function z(a){const l=Ce(a)?a:Math.floor((o.value-i.value/2)/-i.value),{loop:r}=e;return l<=-1?r?-1:0:l>=n.value?r?n.value:n.value-1:l}function re(a){const{loop:l}=e;return a===-1?l?n.value-1:0:a===n.value?l?0:n.value-1:a}function E(a){return e.loop?a<0?n.value+a:a>=n.value?a-n.value:a:Be(a,0,n.value-1)}async function D(){const a=o.value>=i.value,l=o.value<=-f.value,r=0,s=-(f.value-i.value);c.value=!0,(a||l)&&(c.value=!0,o.value=l?r:s,h(0).setTranslate(0),h(n.value-1).setTranslate(0)),await F(),c.value=!1}function P(){q||(t.value=E(Y(e.initialIndex)),q=!0)}function H(){const{autoplay:a}=e;!a||n.value<=1||(b(),N=window.setTimeout(()=>{A(),H()},Y(a)))}function b(){N&&clearTimeout(N)}function M(a){o.value=a,ue()}async function se(a){n.value<=1||!e.touchable||(le(a),b(),await D(),c.value=!0)}function ve(a){const{touchable:l,vertical:r}=e;!W.value||!l||(oe(a),X.value&&(a.preventDefault(),M(o.value+(r?_.value:x.value))))}function fe(){if(!W.value||(ie(),!X.value))return;const{vertical:a,onChange:l}=e,r=a?Z.value<0:Q.value<0,s=a?ae.value:ee.value,I=performance.now()-te.value<=Fe&&s>=Le?z(r?t.value+1:t.value-1):z();c.value=!1,M(I*-i.value);const he=t.value;t.value=re(I),H(),he!==t.value&&$(l,t.value)}function w(){u.value&&(c.value=!0,i.value=e.vertical?u.value.offsetHeight:u.value.offsetWidth,f.value=i.value*n.value,o.value=t.value*-i.value,v.forEach(a=>{a.setTranslate(0)}),H(),setTimeout(()=>{c.value=!1}))}async function A(a){if(n.value<=1)return;P();const{loop:l,onChange:r}=e,s=t.value;if(t.value=E(s+1),(a==null?void 0:a.event)!==!1&&$(r,t.value),await D(),s===n.value-1&&l){h(0).setTranslate(f.value),o.value=n.value*-i.value;return}s!==n.value-1&&(o.value=t.value*-i.value)}async function R(a){if(n.value<=1)return;P();const{loop:l,onChange:r}=e,s=t.value;if(t.value=E(s-1),(a==null?void 0:a.event)!==!1&&$(r,t.value),await D(),s===0&&l){h(n.value-1).setTranslate(-f.value),o.value=i.value;return}s!==0&&(o.value=t.value*-i.value)}function ce(a,l){if(n.value<=1||a===t.value)return;a=a<0?0:a,a=a>=n.value?n.value:a;const r=a>t.value?A:R,s=Math.abs(a-t.value);Array.from({length:s}).forEach((de,I)=>{r({event:I===s-1?l==null?void 0:l.event:!1})})}return{length:n,index:t,swipeEl:u,trackSize:f,trackTranslate:o,lockDuration:c,hovering:k,n:We,classes:Xe,handleTouchstart:se,handleTouchmove:ve,handleTouchend:fe,next:A,prev:R,to:ce,resize:w,toNumber:Y,handleHovering:a=>{e.navigation==="hover"&&(k.value=a)}}}});const Me=["onClick"];function Re(e,u,i,L,f,o){const c=K("var-icon"),t=K("var-button"),k=ze("hover");return Ee((p(),g("div",{class:d(e.n()),ref:"swipeEl"},[De("div",{class:d(e.classes(e.n("track"),[e.vertical,e.n("--vertical")])),style:U({width:e.vertical?void 0:`${e.trackSize}px`,height:e.vertical?`${e.trackSize}px`:void 0,transform:`translate${e.vertical?"Y":"X"}(${e.trackTranslate}px)`,transitionDuration:e.lockDuration?"0ms":`${e.toNumber(e.duration)}ms`}),onTouchstart:u[0]||(u[0]=(...v)=>e.handleTouchstart&&e.handleTouchstart(...v)),onTouchmove:u[1]||(u[1]=(...v)=>e.handleTouchmove&&e.handleTouchmove(...v)),onTouchend:u[2]||(u[2]=(...v)=>e.handleTouchend&&e.handleTouchend(...v))},[C(e.$slots,"default")],38),e.navigation?C(e.$slots,"prev",{key:0,index:e.index,length:e.length,prev:e.prev,next:e.next,to:e.to},()=>[T(G,{name:e.navigation==="hover"?e.n("--navigation-prev-transition"):""},{default:B(()=>[e.hovering||e.navigation===!0?(p(),g("div",{key:0,class:d(e.classes(e.n("navigation"),e.n("navigation-prev"))),onClick:u[3]||(u[3]=v=>e.prev())},[T(t,{"var-swipe-cover":"",class:d(e.n("navigation-prev-button"))},{default:B(()=>[T(c,{"var-swipe-cover":"",class:d(e.n("navigation-prev-button-icon")),name:"chevron-left"},null,8,["class"])]),_:1},8,["class"])],2)):y("",!0)]),_:1},8,["name"])]):y("",!0),e.navigation?C(e.$slots,"next",{key:1,index:e.index,length:e.length,prev:e.prev,next:e.next,to:e.to},()=>[T(G,{name:e.navigation==="hover"?e.n("--navigation-next-transition"):""},{default:B(()=>[e.hovering||e.navigation===!0?(p(),g("div",{key:0,class:d(e.classes(e.n("navigation"),e.n("navigation-next"))),onClick:u[4]||(u[4]=v=>e.next())},[T(t,{"var-swipe-cover":"",class:d(e.n("navigation-next-button"))},{default:B(()=>[T(c,{"var-swipe-cover":"",class:d(e.n("navigation-next-button-icon")),name:"chevron-right"},null,8,["class"])]),_:1},8,["class"])],2)):y("",!0)]),_:1},8,["name"])]):y("",!0),C(e.$slots,"indicator",{index:e.index,length:e.length,prev:e.prev,next:e.next,to:e.to},()=>[e.indicator&&e.length?(p(),g("div",{key:0,class:d(e.classes(e.n("indicators"),[e.vertical,e.n("--indicators-vertical")]))},[(p(!0),g(Pe,null,He(e.length,(v,S)=>(p(),g("div",{class:d(e.classes(e.n("indicator"),[e.index===S,e.n("--indicator-active")],[e.vertical,e.n("--indicator-vertical")])),style:U({background:e.indicatorColor}),key:v,onClick:n=>e.to(S)},null,14,Me))),128))],2)):y("",!0)])],2)),[[k,e.handleHovering,"desktop"]])}const Oe=Ne(qe,[["render",Re]]);ye(Oe);export{Oe as S,Ye as p};
